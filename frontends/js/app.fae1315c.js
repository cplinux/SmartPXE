(function(e){function t(t){for(var n,i,o=t[0],l=t[1],c=t[2],d=0,m=[];d<o.length;d++)i=o[d],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&m.push(r[i][0]),r[i]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n]);u&&u(t);while(m.length)m.shift()();return s.push.apply(s,c||[]),a()}function a(){for(var e,t=0;t<s.length;t++){for(var a=s[t],n=!0,o=1;o<a.length;o++){var l=a[o];0!==r[l]&&(n=!1)}n&&(s.splice(t--,1),e=i(i.s=a[0]))}return e}var n={},r={app:0},s=[];function i(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=e,i.c=n,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(a,n,function(t){return e[t]}.bind(null,n));return a},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var u=l;s.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"00ef":function(e,t,a){},"0ac2":function(e,t,a){"use strict";a("b783")},1576:function(e,t,a){},"1fc8":function(e,t,a){"use strict";a("00ef")},3199:function(e,t,a){"use strict";a("d211")},4294:function(e,t,a){"use strict";a("45d1")},"45d1":function(e,t,a){},4678:function(e,t,a){var n={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn-bd":"9686","./bn-bd.js":"9686","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-in":"ec2e","./en-in.js":"ec2e","./en-nz":"6f50","./en-nz.js":"6f50","./en-sg":"b7e9","./en-sg.js":"b7e9","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-mx":"b5b7","./es-mx.js":"b5b7","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fil":"d69a","./fil.js":"d69a","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-deva":"aaf2","./gom-deva.js":"aaf2","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./oc-lnc":"167b","./oc-lnc.js":"167b","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tk":"5aff","./tk.js":"5aff","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-mo":"3a6c","./zh-mo.js":"3a6c","./zh-tw":"90ea","./zh-tw.js":"90ea"};function r(e){var t=s(e);return a(t)}function s(e){if(!a.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}r.keys=function(){return Object.keys(n)},r.resolve=s,e.exports=r,r.id="4678"},"51f4":function(e,t,a){"use strict";a("aefc")},"56d7":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d"),a("4de4"),a("d3b7");var n=a("2b0e"),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("router-view")],1)},s=[],i={},o=i,l=a("2877"),c=Object(l["a"])(o,r,s,!1,null,null,null),u=c.exports,d=a("8c4f"),m=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"login_container"},[a("div",{staticClass:"login_box"},[e._m(0),a("div",{staticClass:"ms-title"},[e._v("SmartPXE智能部署平台")]),a("el-form",{ref:"loginFormRef",staticClass:"login_form",attrs:{model:e.loginForm,rules:e.loginRules}},[a("el-form-item",{attrs:{prop:"username"}},[a("el-input",{attrs:{placeholder:"请输入用户名","prefix-icon":"el-icon-user"},model:{value:e.loginForm.username,callback:function(t){e.$set(e.loginForm,"username",t)},expression:"loginForm.username"}})],1),a("el-form-item",{attrs:{prop:"password"}},[a("el-input",{attrs:{placeholder:"请输入密码","prefix-icon":"el-icon-lock"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.login.apply(null,arguments)}},model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password",t)},expression:"loginForm.password"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.login}},[e._v("登陆")]),a("el-button",{attrs:{type:"danger"},on:{click:e.resetLoginForm}},[e._v("重置")])],1)],1)],1)])},p=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"avatar_box"},[n("img",{attrs:{src:a("cf05"),alt:"logo"}})])}],f=a("1da1"),g=(a("96cf"),{data:function(){return{loginForm:{username:"",password:""},loginRules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:5,max:10,message:"长度在 5 到 10 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:5,max:16,message:"长度在 5 到 16 个字符",trigger:"blur"}]}}},methods:{resetLoginForm:function(){},login:function(){var e=this;this.$refs.loginFormRef.validate(function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(a,n){var r,s,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!a){t.next=6;break}return t.next=3,e.$http.post("login/",e.loginForm);case 3:r=t.sent,s=r.data,s.code?e.$message.error(s.message):(e.$message.success("登陆成功，欢迎使用！"),i=s.access,window.localStorage.setItem("token",i),e.$router.push("/home"));case 6:case"end":return t.stop()}}),t)})));return function(e,a){return t.apply(this,arguments)}}())}}}),b=g,h=(a("843d"),Object(l["a"])(b,m,p,!1,null,"c682aa96",null)),v=h.exports,w=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-container",[n("el-header",[n("div",{staticClass:"logo"},[n("img",{attrs:{src:a("cf05"),alt:"logo"}}),n("div",{staticClass:"title"},[e._v("SmartPXE智能部署平台")]),n("div",[n("i",{class:e.isCollapse?"el-icon-s-unfold":"el-icon-s-fold",on:{click:e.caidan}})])]),n("div",{staticClass:"user"},[n("div",{staticClass:"user-avator"},[n("img",{attrs:{src:a("cf05")}})]),n("el-dropdown",{on:{command:e.handleCommand}},[n("span",{staticClass:"el-dropdown-link"},[e._v(e._s(e.user.username)),n("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",{attrs:{divided:"",command:"logout"}},[e._v("退出登陆")])],1)],1),n("el-dialog",{attrs:{title:"修改用户密码",visible:e.chpwdDialogFormVisible},on:{"update:visible":function(t){e.chpwdDialogFormVisible=t},close:function(t){return e.resetForm("chpwdUser")}}},[n("el-form",{ref:"chpwdUser",attrs:{model:e.chpwdUserForm,rules:e.chpwdUserRules,"label-width":"100px"}},[n("el-form-item",{attrs:{label:"用户名"}},[e._v(" "+e._s(e.user.username)+" ")]),n("el-form-item",{attrs:{label:"旧密码",prop:"oldPassword"}},[n("el-input",{model:{value:e.chpwdUserForm.oldPassword,callback:function(t){e.$set(e.chpwdUserForm,"oldPassword",t)},expression:"chpwdUserForm.oldPassword"}})],1),n("el-form-item",{attrs:{label:"新密码",prop:"newPassword"}},[n("el-input",{model:{value:e.chpwdUserForm.newPassword,callback:function(t){e.$set(e.chpwdUserForm,"newPassword",t)},expression:"chpwdUserForm.newPassword"}})],1),n("el-form-item",{attrs:{label:"确认密码",prop:"checkpass"}},[n("el-input",{model:{value:e.chpwdUserForm.checkpass,callback:function(t){e.$set(e.chpwdUserForm,"checkpass",t)},expression:"chpwdUserForm.checkpass"}})],1)],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"danger"},on:{click:function(t){e.chpwdDialogFormVisible=!1}}},[e._v("取 消")]),n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.chpwdUser(e.user.id)}}},[e._v("确 定")])],1)],1)],1)]),n("el-container",[n("el-aside",{attrs:{width:e.isCollapse?"64px":"200px"}},[n("el-menu",{attrs:{collapse:e.isCollapse,"collapse-transition":!1,"background-color":"#123","text-color":"#fff","active-text-color":"#ffd04b",router:!0,"default-active":this.$route.path,"unique-opened":!0}},[n("el-submenu",{attrs:{index:"1"}},[n("template",{slot:"title"},[n("i",{staticClass:"el-icon-s-home"}),n("span",[e._v("首页")])]),n("el-menu-item",{attrs:{index:"/dashboard"}},[e._v("Dashboard")]),n("el-menu-item",{attrs:{index:"/discovered"}},[e._v("发现设备")])],2),n("el-submenu",{attrs:{index:"2"}},[n("template",{slot:"title"},[n("i",{staticClass:"el-icon-monitor"}),n("span",[e._v("设备管理")])]),n("el-menu-item",{attrs:{index:"/presettings",disabled:""}},[e._v("预先配置")]),n("el-menu-item",{attrs:{index:"/prelist"}},[e._v("准备列表")]),n("el-menu-item",{attrs:{index:"/installing"}},[e._v("正在安装")]),n("el-menu-item",{attrs:{index:"/installed"}},[e._v("安装记录")])],2),n("el-submenu",{attrs:{index:"3"}},[n("template",{slot:"title"},[n("i",{staticClass:"el-icon-suitcase-1"}),n("span",[e._v("任务管理")])]),n("el-menu-item",{attrs:{index:"/hostlist"}},[e._v("主机列表")]),n("el-menu-item",{attrs:{index:"/tasktemps"}},[e._v("任务模板")]),n("el-menu-item",{attrs:{index:"/taskresult"}},[e._v("任务记录")])],2),n("el-submenu",{attrs:{index:"4"}},[n("template",{slot:"title"},[n("i",{staticClass:"el-icon-notebook-1"}),n("span",[e._v("模板管理")])]),n("el-menu-item",{attrs:{index:"/images"}},[e._v("镜像模板")]),n("el-menu-item",{attrs:{index:"/ostemps"}},[e._v("系统模板")]),n("el-menu-item",{attrs:{index:"/hwtemps",disabled:""}},[e._v("硬件模板")])],2)],1)],1),n("el-main",[n("router-view")],1)],1)],1)},x=[],y={created:function(){},data:function(){var e=this,t=function(t,a,n){a!==e.chpwdUserForm.newPassword?n(new Error("两次输入密码不一致!")):n()},a=function(t,a,n){a===e.chpwdUserForm.oldPassword?n(new Error("新密码不能与旧密码相同！")):n()};return{menulist:[],isCollapse:!1,user:{},chpwdUserForm:{oldPassword:"",newPassword:"",checkpass:""},chpwdDialogFormVisible:!1,chpwdUserRules:{oldPassword:[{required:!0,message:"请输入旧密码",trigger:"blur"}],newPassword:[{required:!0,message:"请输入新密码",trigger:"blur"},{min:4,max:16,message:"长度在 4 到 16个字符",trigger:"blur"},{validator:a,trigger:"blur"}],checkpass:[{required:!0,message:"请确认新密码",trigger:"blur"},{validator:t,trigger:"blur"}]}}},methods:{resetForm:function(e){this.$refs[e].resetFields()},logout:function(){window.localStorage.removeItem("token"),this.$message("退出成功！"),this.$router.push("/login")},getMenuList:function(){var e=this;return Object(f["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("users/menulist/");case 2:if(a=t.sent,n=a.data,!n.code){t.next=6;break}return t.abrupt("return",e.$message.error(n.message));case 6:e.menulist=n.data;case 7:case"end":return t.stop()}}),t)})))()},caidan:function(){this.isCollapse=!this.isCollapse},handleCommand:function(e){"chpwd"===e?this.chpwdDialogFormVisible=!0:"logout"===e&&this.logout()},chpwdUser:function(e){var t=this,a="chpwdUser";this.$refs[a].validate(function(){var a=Object(f["a"])(regeneratorRuntime.mark((function a(n){var r,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!n){a.next=9;break}return a.next=3,t.$http.post("users/mgr/".concat(e,"/setpwd/"),t.chpwdUserForm);case 3:if(r=a.sent,s=r.data,!s.code){a.next=7;break}return a.abrupt("return",t.$message.error(s.message));case 7:t.$message.success("修改密码成功"),t.chpwdDialogFormVisible=!1;case 9:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}())},getUserInfo:function(){var e=this;return Object(f["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("users/mgr/whoami/");case 2:if(a=t.sent,n=a.data,!n.code){t.next=6;break}return t.abrupt("return",e.$message.error(n.message));case 6:e.user=n.user;case 7:case"end":return t.stop()}}),t)})))()}}},k=y,_=(a("4294"),Object(l["a"])(k,w,x,!1,null,"f91aab72",null)),C=_.exports,$=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),a("el-breadcrumb-item",[e._v("Dashboard")])],1),a("el-row",{attrs:{gutter:12}},[a("el-col",{attrs:{span:6}},[a("el-card",{attrs:{shadow:"hover"}},[a("div",{staticClass:"flex justify-between"},[a("div",{staticClass:"icon"},[a("i",{staticClass:"el-icon-monitor",staticStyle:{"font-size":"40px"}})]),a("div",{staticClass:"data flex justify-between"},[a("div",[e._v("在线待处理")]),a("span",[e._v(e._s(e.status.online))])])])])],1),a("el-col",{attrs:{span:6}},[a("el-card",{attrs:{shadow:"hover"}},[a("div",{staticClass:"flex justify-between"},[a("div",{staticClass:"icon"},[a("i",{staticClass:"el-icon-loading",staticStyle:{"font-size":"40px"}})]),a("div",{staticClass:"data flex justify-between"},[a("div",[e._v("正在安装")]),a("span",[e._v(e._s(e.status.running))])])])])],1),a("el-col",{attrs:{span:6}},[a("el-card",{attrs:{shadow:"hover"}},[a("div",{staticClass:"flex justify-between"},[a("div",{staticClass:"icon"},[a("i",{staticClass:"el-icon-circle-check",staticStyle:{"font-size":"40px"}})]),a("div",{staticClass:"data flex justify-between"},[a("div",[e._v("安装成功")]),a("span",[e._v(e._s(e.status.success))])])])])],1),a("el-col",{attrs:{span:6}},[a("el-card",{attrs:{shadow:"hover"}},[a("div",{staticClass:"flex justify-between"},[a("div",{staticClass:"icon"},[a("i",{staticClass:"el-icon-circle-close",staticStyle:{"font-size":"40px"}})]),a("div",{staticClass:"data flex justify-between"},[a("div",[e._v("安装失败")]),a("span",[e._v(e._s(e.status.failed))])])])])],1)],1),a("el-row",{staticStyle:{"margin-top":"15px"},attrs:{gutter:24}},[a("el-col",{attrs:{span:8}},[a("el-card",{attrs:{shadow:"hover"}},[a("div",{staticStyle:{height:"300px"},attrs:{id:"cpu"}})])],1),a("el-col",{attrs:{span:8}},[a("el-card",{attrs:{shadow:"hover"}},[a("div",{staticStyle:{height:"300px"},attrs:{id:"mem"}})])],1),a("el-col",{attrs:{span:8}},[a("el-card",{attrs:{shadow:"hover"}},[a("div",{staticStyle:{height:"300px"},attrs:{id:"disk"}})])],1)],1),a("el-row",{staticStyle:{"margin-top":"15px"},attrs:{gutter:12}},[a("el-col",{attrs:{span:24}},[a("el-card",{attrs:{shadow:"hover"}},[a("div",{staticStyle:{height:"300px"},attrs:{id:"statistical"}})])],1)],1)],1)},j=[],F=(a("ddb0"),a("313e")),I={mounted:function(){this.initEcharts(),this.getMonitorInfo(),this.getStatusInfo(),this.getHistoryInfo()},data:function(){return{status:{success:0,failed:0,online:0,running:0},chartObj:{cpu:0,mem:0,disk:0},historyObj:{days:[],success:[],failed:[]},echarts_cpu:"",echarts_mem:"",echarts_disk:"",echarts_history:""}},methods:{initEcharts:function(){this.echarts_cpu=F["init"](document.getElementById("cpu")),this.echarts_mem=F["init"](document.getElementById("mem")),this.echarts_disk=F["init"](document.getElementById("disk")),this.echarts_history=F["init"](document.getElementById("statistical")),this.echarts_cpu.showLoading(),this.echarts_mem.showLoading(),this.echarts_disk.showLoading(),this.echarts_history.showLoading()},getStatusInfo:function(){var e=this;return Object(f["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("dashboard/status/");case 2:if(a=t.sent,n=a.data,!n.code){t.next=6;break}return t.abrupt("return",e.$message.error(n.code));case 6:e.status=n;case 7:case"end":return t.stop()}}),t)})))()},getMonitorInfo:function(){var e=this;return Object(f["a"])(regeneratorRuntime.mark((function t(){var a,n,r,s,i,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("dashboard/sysinfo/");case 2:if(a=t.sent,n=a.data,!n.code){t.next=6;break}return t.abrupt("return",e.$message.error(n.code));case 6:e.chartObj=n,t.t0=regeneratorRuntime.keys(e.chartObj);case 8:if((t.t1=t.t0()).done){t.next=31;break}r=t.t1.value,s=r.toUpperCase(),i=e.chartObj[r],o={title:{text:s+"使用率"},tooltip:{formatter:"已经使用: {c}%"},toolbox:{feature:{restore:{},saveAsImage:{}}},series:[{name:s+"图表",type:"gauge",detail:{formatter:"{value}%"},data:[{value:i}]}]},t.t2=r,t.next="cpu"===t.t2?16:"mem"===t.t2?20:"disk"===t.t2?24:28;break;case 16:return e.echarts_cpu.setOption(o,!0),e.echarts_cpu.hideLoading(),window.onresize=function(){this.echarts_cpu.resize()},t.abrupt("break",29);case 20:return e.echarts_mem.setOption(o,!0),e.echarts_mem.hideLoading(),window.onresize=function(){this.echarts_mem.resize()},t.abrupt("break",29);case 24:return e.echarts_disk.setOption(o,!0),e.echarts_disk.hideLoading(),window.onresize=function(){this.echarts_disk.resize()},t.abrupt("break",29);case 28:return t.abrupt("break",29);case 29:t.next=8;break;case 31:case"end":return t.stop()}}),t)})))()},getHistoryInfo:function(){var e=this;return Object(f["a"])(regeneratorRuntime.mark((function t(){var a,n,r,s,i,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("dashboard/history/");case 2:if(a=t.sent,n=a.data,!n.code){t.next=6;break}return t.abrupt("return",e.$message.error(n.code));case 6:e.historyObj=n,r="days",s="success",i="failed",o={title:{text:"前30天的安装统计"},tooltip:{trigger:"axis"},legend:{data:["安装成功","安装失败"]},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},toolbox:{feature:{saveAsImage:{}}},xAxis:{type:"category",boundaryGap:!1,data:e.historyObj[r]},yAxis:{type:"value"},series:[{name:"安装成功",type:"line",stack:"Total",data:e.historyObj[s]},{name:"安装失败",type:"line",stack:"Total",data:e.historyObj[i]}]},e.echarts_history.setOption(o,!0),e.echarts_history.hideLoading(),window.onresize=function(){this.echarts_history.resize()};case 14:case"end":return t.stop()}}),t)})))()}}},S=I,R=(a("8378"),Object(l["a"])(S,$,j,!1,null,"af4760b4",null)),L=R.exports,z=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),a("el-breadcrumb-item",[e._v("发现设备")])],1),a("el-card",{staticClass:"box-card"},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:6}},[a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},slot:"append"})],1)],1),a("el-col",{attrs:{span:2}},[a("el-button",{attrs:{type:"success"},on:{click:function(t){return e.getHostList()}}},[e._v("手动刷新")])],1),a("el-col",{attrs:{span:3}},[a("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.cycleRunFunc(0)}}},[e._v("停止自动刷新")])],1)],1),a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.hostList,"row-key":"mac",border:""}},[a("el-table-column",{attrs:{type:"selection","reserve-selection":!0,width:"45"}}),a("el-table-column",{attrs:{type:"index",label:"ID"}}),a("el-table-column",{attrs:{prop:"sn",label:"SN",width:"180"}}),a("el-table-column",{attrs:{prop:"vender",label:"生厂商"}}),a("el-table-column",{attrs:{prop:"product",label:"产品型号"}}),a("el-table-column",{attrs:{prop:"cpuinfo",label:"CPU"}}),a("el-table-column",{attrs:{prop:"meminfo",label:"内存"}}),a("el-table-column",{attrs:{prop:"clientip",label:"Client IP"}}),a("el-table-column",{attrs:{prop:"ipmi",label:"IPMI IP"}}),a("el-table-column",{attrs:{prop:"date",label:"更新时间",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(" "+e._s(e._f("dateFmt")(n.date)))])]}}])}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"200px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"info",size:"small"},on:{click:function(a){return e.handleInfo(t.row)}}},[e._v("查看")]),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(a){return e.handleDel(t.row)}}},[e._v("删除")])]}}])})],1),a("el-pagination",{attrs:{"current-page":e.pagination.page,"page-size":e.pagination.size,layout:"total, prev, pager, next, jumper",total:e.pagination.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),a("div",{staticStyle:{"margin-top":"20px"}},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.handleInstall()}}},[e._v("进入装机")]),a("el-button",{attrs:{type:"success",size:"small"},on:{click:function(t){return e.handleTask()}}},[e._v("进入任务")]),a("el-button",{attrs:{type:"danger",size:"small",disabled:""}},[e._v("关机")]),a("el-button",{attrs:{type:"danger",size:"small",disabled:""}},[e._v("删除")]),a("el-button",{attrs:{type:"info",size:"small",disabled:""}},[e._v("信息导出")])],1)],1),a("h2",[e._v("这里的设备:")]),a("li",[e._v("刚进入时为【自动刷新】，可手动设置【停止自动刷新】")]),a("li",[e._v("按了【查看】后，可以查看更详细的信息")]),a("li",[e._v('按了【进入装机】后，进入"部署流"，可以在【设备管理】的【准备列表】中查看')]),a("li",[e._v('按了【进入任务】后，进入"任务流"，可以在【任务管理】的【准备列表】中查看')]),a("li",[e._v("按了【删除】后，将失去与【BootOS】的链接，只有【重启BootOS】才可以重新查看到")]),a("el-drawer",{ref:"drawer",attrs:{title:"设备: "+e.SysInfo.SN+" 的详细信息","before-close":e.handleClose,visible:e.dialog,direction:"rtl",size:"70%","custom-class":"demo-drawer",border:!0},on:{"update:visible":function(t){e.dialog=t}}},[a("div",{staticClass:"demo-drawer__content"},[a("el-descriptions",{staticClass:"margin-top",attrs:{title:"设备详情",column:4,border:"",size:"small"}},[a("el-descriptions-item",{attrs:{label:"SN"}},[a("el-tag",{attrs:{size:"medium"}},[a("font",{attrs:{size:"6"}},[e._v(e._s(e.SysInfo.SN))])],1)],1),a("el-descriptions-item",{attrs:{label:"厂商"}},[e._v(e._s(e.SysInfo.Vender))]),a("el-descriptions-item",{attrs:{label:"产品型号"}},[e._v(e._s(e.SysInfo.Product))]),a("el-descriptions-item",{attrs:{label:"是否为虚拟机"}},[e._v(e._s(e.SysInfo.isVM?"是":"否"))]),a("el-descriptions-item",{attrs:{label:"CPU信息",span:4}},[a("el-table",{attrs:{data:e.SysInfo.CPU,border:""}},[a("el-table-column",{attrs:{prop:"slot",label:"槽位"}}),a("el-table-column",{attrs:{prop:"model",label:"型号"}}),a("el-table-column",{attrs:{prop:"core",label:"核心"}})],1)],1),a("el-descriptions-item",{attrs:{label:"内存信息",span:4}},[a("el-table",{attrs:{data:e.SysInfo.MEM,border:""}},[a("el-table-column",{attrs:{prop:"slot",label:"槽位"}}),a("el-table-column",{attrs:{prop:"size",label:"大小"}}),a("el-table-column",{attrs:{prop:"description",label:"描述信息"}})],1)],1),a("el-descriptions-item",{attrs:{label:"网卡信息",span:4}},[a("el-table",{attrs:{data:e.SysInfo.ETH,border:""}},[a("el-table-column",{attrs:{prop:"name",label:"名称"}}),a("el-table-column",{attrs:{prop:"mac",label:"MAC地址"}}),a("el-table-column",{attrs:{prop:"product",label:"产品型号"}}),a("el-table-column",{attrs:{prop:"description",label:"描述信息"}})],1)],1),a("el-descriptions-item",{attrs:{label:"磁盘信息",span:4}},[a("el-table",{attrs:{data:e.SysInfo.DISK,border:""}},[a("el-table-column",{attrs:{type:"index",label:"ID"}}),a("el-table-column",{attrs:{prop:"product",label:"产品型号"}}),a("el-table-column",{attrs:{prop:"type",label:"类型"}}),a("el-table-column",{attrs:{prop:"size",label:"大小"}})],1)],1),a("el-descriptions-item",{attrs:{label:"阵列卡信息",span:4}},[a("el-table",{attrs:{data:e.SysInfo.RAID,border:""}},[a("el-table-column",{attrs:{type:"index",label:"ID"}}),a("el-table-column",{attrs:{prop:"type",label:"类型"}}),a("el-table-column",{attrs:{prop:"product",label:"产品型号"}}),a("el-table-column",{attrs:{prop:"description",label:"描述信息"}})],1)],1),a("el-descriptions-item",{attrs:{label:"IPMI",span:4}},[a("el-table",{attrs:{data:e.SysInfo.IPMI,border:""}},[a("el-table-column",{attrs:{prop:"mac",label:"MAC地址"}}),a("el-table-column",{attrs:{prop:"ipaddr",label:"IP地址"}}),a("el-table-column",{attrs:{prop:"mask",label:"掩码长度"}}),a("el-table-column",{attrs:{prop:"gateway",label:"网关"}})],1)],1)],1),a("div",{staticClass:"demo-drawer__footer"})],1)])],1)},O=[],D=(a("159b"),a("e9c4"),a("a434"),{created:function(){this.getHostList(),this.cycleRunFunc(1,this.getHostList,5e3)},beforeDestroy:function(){this.intervalID&&clearInterval(this.intervalID)},data:function(){return{hostList:[],multipleSelection:[],selectArrayMac:[],selectArray:[],intervalID:null,search:null,table:!1,dialog:!1,pagination:{page:1,size:20,total:0},loading:!1,formLabelWidth:"200px",timer:null,size:"",SysInfo:{}}},methods:{handleSizeChange:function(e){},handleCurrentChange:function(e){this.getHostList(e)},cycleRunFunc:function(e,t,a){e?this.intervalID=setInterval(t,a):(clearInterval(this.intervalID),this.$message.success("已停止自动刷新，刷新页面后继续自动刷新"))},getHostList:function(e){var t=this;return Object(f["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e||(e=t.pagination.page),a.next=3,t.$http.get("install/discover/?page=".concat(e));case 3:if(n=a.sent,r=n.data,!r.code){a.next=7;break}return a.abrupt("return",t.$message.error(r.message));case 7:t.hostList=r.results,t.pagination=r.pagination,0!==t.$refs.multipleTable.selection.length&&t.$refs.multipleTable.selection.forEach((function(e){-1===JSON.stringify(t.hostList).indexOf(JSON.stringify(e))&&t.$refs.multipleTable.selection.splice(t.$refs.multipleTable.selection.indexOf(e),1)}));case 10:case"end":return a.stop()}}),a)})))()},handleInstall:function(){var e=this;0!==this.$refs.multipleTable.selection.length?this.$refs.multipleTable.selection.forEach(function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(a){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.post("/install/discover/".concat(a.mac,"/convert/2/"));case 2:if(n=t.sent,r=n.data,!r.code){t.next=6;break}return t.abrupt("return",e.$message.error(r.message));case 6:e.$message.success("".concat(a.mac,"已经成功添加到装机列表")),e.$refs.multipleTable.selection.shift(),e.getHostList();case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()):this.$message.error("当前未选中任何设备")},handleTask:function(){var e=this;0!==this.$refs.multipleTable.selection.length?this.$refs.multipleTable.selection.forEach(function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(a){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.post("/install/discover/".concat(a.mac,"/convert/1/"));case 2:if(n=t.sent,r=n.data,!r.code){t.next=6;break}return t.abrupt("return",e.$message.error(r.message));case 6:e.$message.success("".concat(a.mac,"已经成功添加到任务列表")),e.$refs.multipleTable.selection.shift(),e.getHostList();case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()):this.$message.error("当前未选中任何设备")},handleEdit:function(){},handleDelete:function(e){},handleClose:function(){this.dialog=!1},handleInfo:function(e){this.SysInfo=e.sysinfo,this.dialog=!0},handleDel:function(e){var t=this;this.$msgbox.confirm("此操作将删除该设备, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(f["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.$http.delete("install/discover/".concat(e.mac,"/"));case 2:if(n=a.sent,r=n.data,!r.code){a.next=6;break}return a.abrupt("return",t.$message.error(r.message));case 6:t.getHostList(t.pagination.page),t.$message.success("设备"+e.sn+" 已成功删除");case 8:case"end":return a.stop()}}),a)})))).catch((function(){t.$message({type:"info",message:"已取消删除"})}))}}}),H=D,T=(a("0ac2"),Object(l["a"])(H,z,O,!1,null,"1d5008b1",null)),V=T.exports,P=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),a("el-breadcrumb-item",[e._v("设备管理")]),a("el-breadcrumb-item",[e._v("预先配置")])],1),a("el-card",{staticClass:"box-card"},[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"SN"}},[a("el-select",{staticStyle:{width:"50%"},attrs:{placeholder:"请选择设备的SN"},on:{change:e.handleSNChange},model:{value:e.form.sn,callback:function(t){e.$set(e.form,"sn",t)},expression:"form.sn"}},e._l(e.macList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.sn,value:e.mac}})})),1)],1),a("el-form-item",{attrs:{label:"系统模板"}},[a("el-select",{staticStyle:{width:"50%"},attrs:{placeholder:"请选择系统配置模板"},on:{change:e.handleConfigChange},model:{value:e.form.config,callback:function(t){e.$set(e.form,"config",t)},expression:"form.config"}},e._l(e.configList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:{name:e.name,path:e.path,image:e.image}}})})),1)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addPreSetting()}}},[e._v("立即创建")]),a("el-button",[e._v("取消")])],1)],1),a("el-button",{attrs:{type:"primary"}},[e._v("批量导入")]),a("el-button",{attrs:{type:"info"}},[e._v("下载模板")]),a("h2",[e._v("这里的SN可以在设备加入到【准备列表】后，可以选择")]),a("h2",[e._v("【批量导入】功能后续开启")]),a("h2",[e._v("创建完成后，后台根据对应的系统配置，生成pxe菜单")]),a("h2",[e._v("这里的系统模板获取应该不带分页信息")]),a("h2",[e._v("增加一个： 是否开启vnc")])],1)],1)},E=[],M={created:function(){this.getMacList(),this.getConfigList()},data:function(){return{macList:[],configList:[],form:{sn:"",hostname:"",ipaddr:"",config:""}}},methods:{getMacList:function(){var e=this;return Object(f["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("install/iprelist/allmac/");case 2:if(a=t.sent,n=a.data,!n.code){t.next=6;break}return t.abrupt("return",e.$message.error(n.message));case 6:e.macList=n;case 7:case"end":return t.stop()}}),t)})))()},handleSNChange:function(){},getConfigList:function(){var e=this;return Object(f["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("temp/config/");case 2:if(a=t.sent,n=a.data,!n.code){t.next=6;break}return t.abrupt("return",e.$message.error(n.message));case 6:e.configList=n.results;case 7:case"end":return t.stop()}}),t)})))()},handleConfigChange:function(){},addPreSetting:function(){var e=this,t="form";this.$refs[t].validate(function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(a){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!a){t.next=10;break}return t.next=3,e.$http.patch("install/iprelist/".concat(e.form.sn,"/"),e.form);case 3:if(n=t.sent,r=n.data,!r.code){t.next=7;break}return t.abrupt("return",e.$message.error(r.message));case 7:e.$message.success("配置成功"),t.next=11;break;case 10:e.$message.error("验证失败，请检查内容！");case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},onSubmit:function(){}}},U=M,B=Object(l["a"])(U,P,E,!1,null,"123dbe16",null),q=B.exports,A=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),a("el-breadcrumb-item",[e._v("设备管理")]),a("el-breadcrumb-item",[e._v("准备列表")])],1),a("el-card",{staticClass:"box-card"},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:6}},[a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},slot:"append"})],1)],1),a("el-col",{attrs:{span:2}},[a("el-button",{attrs:{type:"success"},on:{click:function(t){return e.getHostList()}}},[e._v("手动刷新")])],1)],1),a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{"row-key":"mac",data:e.hostList,border:""},on:{select:e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection","reserve-selection":!0,width:"45"}}),a("el-table-column",{attrs:{type:"index",label:"ID"}}),a("el-table-column",{attrs:{prop:"sn",label:"SN",width:"180"}}),a("el-table-column",{attrs:{prop:"vender",label:"生厂商"}}),a("el-table-column",{attrs:{prop:"product",label:"产品型号"}}),a("el-table-column",{attrs:{prop:"os",label:"即将安装的系统"}}),a("el-table-column",{attrs:{prop:"config",label:"系统配置"}}),a("el-table-column",{attrs:{prop:"clientip",label:"Client IP"}}),a("el-table-column",{attrs:{prop:"ipmi",label:"IPMI IP"}}),a("el-table-column",{attrs:{prop:"join_date",label:"加入时间",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(" "+e._s(e._f("dateFmt")(n.join_date)))])]}}])}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"200px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"info",size:"small"},on:{click:function(a){return e.handleEdit(t.row)}}},[e._v("编辑")]),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(a){return e.handleDel(t.row)}}},[e._v("删除")])]}}])})],1),a("el-pagination",{attrs:{"current-page":e.pagination.page,"page-size":e.pagination.size,layout:"total, prev, pager, next, jumper",total:e.pagination.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),a("div",{staticStyle:{"margin-top":"20px"}},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.handleInstall()}}},[e._v("立即安装")]),a("el-button",{attrs:{type:"success",size:"small"},on:{click:function(t){return e.handleTask()}}},[e._v("更改到任务列表")]),a("el-button",{attrs:{type:"danger",size:"small",disabled:""}},[e._v("关机")])],1),a("h2",[e._v("这里可以修改安装的信息，生成安装菜单")]),a("h2",[e._v('按下【立即安装】后：该列表内的数据"转换"到安装记录表中，然后进行硬件配置，重启BootOS，安装系统等等')])],1),a("el-dialog",{attrs:{title:"修改配置",visible:e.editDialogFormVisible},on:{"update:visible":function(t){e.editDialogFormVisible=t},close:function(t){return e.resetForm("editHost")}}},[a("el-form",{ref:"editHost",attrs:{model:e.editHostForm,rules:e.editHostRules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"当前设备"}},[e._v(" "+e._s(e.editHostForm.sn)+" ")]),a("el-form-item",{attrs:{label:"系统模板"}},[a("el-select",{staticStyle:{width:"50%"},attrs:{placeholder:"请选择系统配置模板"},on:{change:e.handleConfigChange},model:{value:e.editHostForm.config,callback:function(t){e.$set(e.editHostForm,"config",t)},expression:"editHostForm.config"}},e._l(e.configList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:{name:e.name,path:e.path,image:e.image}}})})),1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"danger"},on:{click:function(t){e.editDialogFormVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.editHost}},[e._v("确 定")])],1)],1)],1)},N=[],G={created:function(){this.getHostList(),this.getConfigList()},data:function(){return{hostList:[],multipleSelection:[],selectArray:[],search:null,pagination:{page:1,size:20,total:0},editDialogFormVisible:!1,editHostForm:{sn:"",mac:"",config:""},editHostRules:{},configList:[]}},methods:{resetForm:function(e){this.$refs[e].resetFields()},handleSizeChange:function(e){},handleCurrentChange:function(e){this.getHostList(e)},getHostList:function(e){var t=this;return Object(f["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e||(e=t.pagination.page),a.next=3,t.$http.get("install/iprelist/?page=".concat(e));case 3:if(n=a.sent,r=n.data,!r.code){a.next=7;break}return a.abrupt("return",t.$message.error(r.message));case 7:t.hostList=r.results,t.pagination=r.pagination;case 9:case"end":return a.stop()}}),a)})))()},handleSelectionChange:function(e){this.multipleSelection=e},handleInstall:function(){var e=this;this.selectArray=[],this.multipleSelection.forEach((function(t){e.selectArray.push(t.mac)})),this.selectArray.forEach(function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(a){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.post("/install/iprelist/".concat(a,"/install/"));case 2:if(n=t.sent,r=n.data,!r.code){t.next=6;break}return t.abrupt("return",e.$message.error(r.message));case 6:e.$message.success("".concat(a,"已经成功添加到了装机队列")),e.getHostList();case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),this.selectArray=[]},handleEdit:function(e){this.editHostForm=e,this.editDialogFormVisible=!0},getConfigList:function(){var e=this;return Object(f["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("temp/config/");case 2:if(a=t.sent,n=a.data,!n.code){t.next=6;break}return t.abrupt("return",e.$message.error(n.message));case 6:e.configList=n.results;case 7:case"end":return t.stop()}}),t)})))()},handleConfigChange:function(){},editHost:function(){var e=this,t="editHost";this.$refs[t].validate(function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(a){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!a){t.next=12;break}return t.next=3,e.$http.patch("install/iprelist/".concat(e.editHostForm.mac,"/"),e.editHostForm);case 3:if(n=t.sent,r=n.data,!r.code){t.next=7;break}return t.abrupt("return",e.$message.error(r.message));case 7:e.editDialogFormVisible=!1,e.getHostList(e.pagination.page),e.$message.success("配置成功"),t.next=13;break;case 12:e.$message.error("验证失败，请检查内容！");case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},handleDelete:function(){},handlePxeboot:function(){},handleDel:function(e){var t=this;this.$msgbox.confirm("此操作将删除该设备, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(f["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.$http.delete("install/iprelist/".concat(e.mac,"/"));case 2:if(n=a.sent,r=n.data,!r.code){a.next=6;break}return a.abrupt("return",t.$message.error(r.message));case 6:t.getHostList(t.pagination.page),t.$message.success("设备"+e.sn+" 已成功删除");case 8:case"end":return a.stop()}}),a)})))).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},toggleSelection:function(e){var t=this;e?e.forEach((function(e){t.$refs.multipleTable.toggleRowSelection(e)})):this.$refs.multipleTable.clearSelection()},handleTask:function(){var e=this;0!==this.$refs.multipleTable.selection.length?this.$refs.multipleTable.selection.forEach(function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(a){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.post("/install/iprelist/".concat(a.mac,"/convert/"));case 2:if(n=t.sent,r=n.data,!r.code){t.next=6;break}return t.abrupt("return",e.$message.error(r.message));case 6:e.$message.success("".concat(a.mac,"已经成功添加到任务列表")),e.$refs.multipleTable.selection.shift(),e.getHostList();case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()):this.$message.error("当前未选中任何设备")}}},J=G,K=(a("b935"),Object(l["a"])(J,A,N,!1,null,null,null)),W=K.exports,X=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),a("el-breadcrumb-item",[e._v("设备管理")]),a("el-breadcrumb-item",[e._v("正在安装")])],1),a("el-card",{staticClass:"box-card"},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:6}},[a("el-input",{attrs:{placeholder:"请输入内容"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},slot:"append"})],1)],1),a("el-col",{attrs:{span:2}},[a("el-button",{attrs:{type:"success"},on:{click:function(t){return e.getHostList()}}},[e._v("手动刷新")])],1),a("el-col",{attrs:{span:3}},[a("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.cycleRunFunc(0,e.getHostList)}}},[e._v("停止自动刷新")])],1)],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.hostList,border:""},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"45"}}),a("el-table-column",{attrs:{type:"index",label:"ID"}}),a("el-table-column",{attrs:{prop:"sn",label:"SN",width:"180px"}}),a("el-table-column",{attrs:{prop:"vender",label:"生厂商"}}),a("el-table-column",{attrs:{prop:"product",label:"产品型号"}}),a("el-table-column",{attrs:{prop:"os",label:"镜像"}}),a("el-table-column",{attrs:{prop:"config",label:"系统配置"}}),a("el-table-column",{attrs:{prop:"clientip",label:"Client IP"}}),a("el-table-column",{attrs:{prop:"ipmi",label:"IPMI IP"}}),a("el-table-column",{attrs:{prop:"install_date",label:"安装时间",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(" "+e._s(e._f("dateFmt")(n.install_date)))])]}}])}),a("el-table-column",{attrs:{prop:"status_progress",label:"进度"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("el-progress",{attrs:{"text-inside":!0,"stroke-width":26,percentage:parseInt(e.row.status_progress)}})]}}])}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"200px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"info",size:"small"},on:{click:function(a){return e.handleInfo(t.row)}}},[e._v("安装详情")]),a("el-button",{attrs:{slot:"reference",type:"danger",size:"small"},on:{click:function(a){return e.handleDel(t.row)}},slot:"reference"},[e._v("取消安装")])]}}])})],1),a("el-pagination",{attrs:{"current-page":e.pagination.page,"page-size":e.pagination.size,layout:"total, prev, pager, next, jumper",total:e.pagination.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),a("div",{staticStyle:{"margin-top":"20px"}},[a("el-button",{attrs:{type:"danger",size:"small",disabled:""}},[e._v("终止并关机")]),a("el-button",{attrs:{type:"danger",size:"small",disabled:""}},[e._v("终止并重启")])],1)],1),a("el-dialog",{attrs:{title:"正在对: "+e.tempObj.sn+"进行操作",visible:e.delDialogVisible,width:"30%"},on:{"update:visible":function(t){e.delDialogVisible=t}}},[a("span",[e._v("是否确定终止该设备的安装程序")]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.delDialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"danger",disabled:""},on:{click:function(t){return e.handleDelete(e.tempObj.mac,0)}}},[e._v("终止并关机")]),a("el-button",{attrs:{type:"danger",disabled:""},on:{click:function(t){return e.handleDelete(e.tempObj.mac,1)}}},[e._v("终止并重启")]),a("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.handleDelRecord(e.tempObj.mac)}}},[e._v("仅清除记录和pxe菜单")])],1)]),a("el-drawer",{ref:"drawer",attrs:{title:e.tempInfoObj.sn+" 的详细信息","before-close":e.handleClose,visible:e.dialog,direction:"rtl",size:"70%","custom-class":"demo-drawer",border:!0},on:{"update:visible":function(t){e.dialog=t}}},[a("div",{staticClass:"demo-drawer__content"},[a("el-descriptions",{staticClass:"margin-top",attrs:{title:"安装详情",column:1,border:"",size:"small"}},[a("el-descriptions-item",{attrs:{label:"当前状态"}},[a("el-steps",{attrs:{space:200,active:parseInt(e.tempInfoObj.status_id),"finish-status":"success"}},[a("el-step",{attrs:{title:"获取指令"}}),a("el-step",{attrs:{title:"初始化"}}),a("el-step",{attrs:{title:"设置硬件"}}),a("el-step",{attrs:{title:"重启"}}),a("el-step",{attrs:{title:"运行装机程序"}}),a("el-step",{attrs:{title:"安装中"}}),a("el-step",{attrs:{title:"生成系统内核"}}),a("el-step",{attrs:{title:"系统已完成"}})],1)],1),a("el-descriptions-item",{attrs:{label:"实时日志"}},[a("div",[a("h2",[e._v("如果任务日志长时间未更新，请检查是否已经安装完成。")])]),a("el-input",{attrs:{type:"textarea",disabled:!0,rows:20},model:{value:e.tempInfoObj.status_content,callback:function(t){e.$set(e.tempInfoObj,"status_content",t)},expression:"tempInfoObj.status_content"}})],1)],1),a("div",{staticClass:"demo-drawer__footer"})],1)])],1)},Q=[],Y=(a("b0c0"),a("99af"),{created:function(){this.getHostList(),this.cycleRunFunc(1,this.getHostList,5e3)},beforeDestroy:function(){for(var e in this.timerManager)clearInterval(this.timerManager[e])},data:function(){return{delDialogVisible:!1,pagination:{page:1,size:20,total:0},hostList:[],tempInfoObj:{status_id:"",status_content:"",vncInfo:""},tempObj:"",tempMac:"",tempCycleID:"",table:!1,dialog:!1,loading:!1,formLabelWidth:"200px",timer:null,size:"",timerManager:{}}},methods:{cycleRunFunc:function(e,t,a){var n=t.name;if(e){this.$message.success("自动刷新已经开始");var r=setInterval(t,a);this.timerManager[n]=r}else{var s=this.timerManager[n];clearInterval(s),this.timerManager[n]=void 0,this.$message.success("已停止自动刷新")}},getHostList:function(e){var t=this;return Object(f["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e||(e=t.pagination.page),a.next=3,t.$http.get("install/progress/?page=".concat(e));case 3:if(n=a.sent,r=n.data,!r.code){a.next=7;break}return a.abrupt("return",t.$message.error(r.message));case 7:t.hostList=r.results,t.pagination=r.pagination;case 9:case"end":return a.stop()}}),a)})))()},handleSizeChange:function(e){},handleCurrentChange:function(e){this.getHostList(e)},handleDel:function(e){this.delDialogVisible=!0,this.tempObj=e},handleDelete:function(e,t){var a=this;return Object(f["a"])(regeneratorRuntime.mark((function n(){var r,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,a.$http.post("install/progress/".concat(e,"/termination/").concat(t,"/"));case 2:if(r=n.sent,s=r.data,!s.code){n.next=6;break}return n.abrupt("return",a.$message.error(s.message));case 6:a.$message.success("操作成功!"),a.getHostList(),a.delDialogVisible=!1;case 9:case"end":return n.stop()}}),n)})))()},handleInfo:function(e){this.tempInfoObj=e,this.tempMac=e.mac,this.dialog=!0,this.cycleRunFunc(1,this.handleGetOne,3e3)},timeoutMac:function(e,t,a){e.call(t),setTimeout(this.timeoutMac(e,t,a),a)},handleGetOne:function(){var e=this;return Object(f["a"])(regeneratorRuntime.mark((function t(){var a,n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e.tempMac,t.next=3,e.$http.get("install/progress/".concat(a,"/"));case 3:if(n=t.sent,r=n.data,!r.code){t.next=7;break}return t.abrupt("return",e.$message.error(r.message));case 7:e.tempInfoObj=r;case 8:case"end":return t.stop()}}),t)})))()},handleClose:function(){this.tempInfoObj={},this.tempMac="",this.cycleRunFunc(0,this.handleGetOne),this.dialog=!1},handleInstall:function(){},handlePxeboot:function(){},toggleSelection:function(e){var t=this;e?e.forEach((function(e){t.$refs.multipleTable.toggleRowSelection(e)})):this.$refs.multipleTable.clearSelection()},handleSelectionChange:function(e){this.multipleSelection=e},handleDelRecord:function(e){var t=this;this.$msgbox.confirm("此操作将删除该记录, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(f["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.$http.delete("install/progress/".concat(e,"/"));case 2:if(n=a.sent,r=n.data,!r.code){a.next=6;break}return a.abrupt("return",t.$message.error(r.message));case 6:t.getHostList(),t.$message.success("记录已成功删除"),t.delDialogVisible=!1;case 9:case"end":return a.stop()}}),a)})))).catch((function(){t.$message({type:"info",message:"已取消删除"})}))}}}),Z=Y,ee=(a("3199"),Object(l["a"])(Z,X,Q,!1,null,"0a3bcaee",null)),te=ee.exports,ae=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),a("el-breadcrumb-item",[e._v("设备管理")]),a("el-breadcrumb-item",[e._v("安装记录")])],1),a("el-card",{staticClass:"box-card"},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:6}},[a("el-input",{attrs:{placeholder:"请输入内容"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},slot:"append"})],1)],1)],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:""},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"45"}}),a("el-table-column",{attrs:{type:"index",label:"ID"}}),a("el-table-column",{attrs:{prop:"sn",label:"SN",width:"180px"}}),a("el-table-column",{attrs:{prop:"vender",label:"生厂商"}}),a("el-table-column",{attrs:{prop:"product",label:"产品型号"}}),a("el-table-column",{attrs:{prop:"os",label:"镜像"}}),a("el-table-column",{attrs:{prop:"config",label:"系统配置"}}),a("el-table-column",{attrs:{prop:"clientip",label:"Client IP"}}),a("el-table-column",{attrs:{prop:"ipmi",label:"IPMI IP"}}),a("el-table-column",{attrs:{prop:"date",label:"安装时间",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(" "+e._s(e._f("dateFmt")(n.date)))])]}}])}),a("el-table-column",{attrs:{prop:"status",label:"安装结果",width:"100",filters:[{text:"成功",value:1},{text:"失败",value:0}],"filter-method":e.filterTag,"filter-placement":"bottom-end"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("el-tag",{attrs:{type:n.status?"success":"danger","disable-transitions":""}},[e._v(e._s(n.status?"success":"failed"))])]}}])}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"200px"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("el-button",{attrs:{type:"info",size:"small"},on:{click:function(t){return e.handleInfo(n)}}},[e._v("安装详情")]),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(t){return e.handleDel(n.id)}}},[e._v("删除")])]}}])})],1),a("el-pagination",{attrs:{"current-page":e.pagination.page,"page-size":e.pagination.size,layout:"total, prev, pager, next, jumper",total:e.pagination.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),a("div",{staticStyle:{"margin-top":"20px"}},[a("el-button",{attrs:{type:"info",size:"small",disabled:""}},[e._v("信息导出")])],1)],1),a("el-drawer",{ref:"drawer",attrs:{title:e.tempInfoObj.sn+" 的详细信息","before-close":e.handleClose,visible:e.dialog,direction:"rtl",size:"70%","custom-class":"demo-drawer",border:!0},on:{"update:visible":function(t){e.dialog=t}}},[a("div",{staticClass:"demo-drawer__content"},[a("el-descriptions",{staticClass:"margin-top",attrs:{title:"安装详情",column:1,border:"",size:"small"}},[a("el-descriptions-item",{attrs:{label:"当前状态"}},[a("el-steps",{attrs:{space:200,active:parseInt(e.tempInfoObj.status_id),"finish-status":"success"}},[a("el-step",{attrs:{title:"获取指令"}}),a("el-step",{attrs:{title:"初始化"}}),a("el-step",{attrs:{title:"设置硬件"}}),a("el-step",{attrs:{title:"重启"}}),a("el-step",{attrs:{title:"运行装机程序"}}),a("el-step",{attrs:{title:"安装中"}}),a("el-step",{attrs:{title:"生成系统内核"}}),a("el-step",{attrs:{title:"系统已完成"}})],1)],1),a("el-descriptions-item",{attrs:{label:"实时日志"}},[a("el-input",{attrs:{type:"textarea",disabled:!0,rows:20},model:{value:e.tempInfoObj.status_content,callback:function(t){e.$set(e.tempInfoObj,"status_content",t)},expression:"tempInfoObj.status_content"}})],1)],1),a("div",{staticClass:"demo-drawer__footer"})],1)])],1)},ne=[],re={created:function(){this.getList()},data:function(){return{pagination:{page:1,size:20,total:0},table:!1,dialog:!1,loading:!1,formLabelWidth:"200px",timer:null,size:"",tempInfoObj:{status_id:"",status_content:"",vncInfo:""},tableData:[],form:{name:"",region:"",date1:"",date2:"",delivery:!1,type:[],resource:"",desc:""}}},methods:{getList:function(e){var t=this;return Object(f["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e||(e=t.pagination.page),a.next=3,t.$http.get("install/result/?page=".concat(e));case 3:if(n=a.sent,r=n.data,!r.code){a.next=7;break}return a.abrupt("return",t.$message.error(r.message));case 7:t.tableData=r.results,t.pagination=r.pagination;case 9:case"end":return a.stop()}}),a)})))()},filterTag:function(e,t){return t.status===e},filterHandler:function(e,t,a){var n=a.property;return t[n]===e},handleSizeChange:function(e){},handleCurrentChange:function(e){this.getList(e)},handleClose:function(){this.dialog=!1},handleInfo:function(e){this.tempInfoObj=e,this.tempMac=e.mac,this.dialog=!0},handleInstall:function(){},handlePxeboot:function(){},handleDel:function(e){var t=this;this.$msgbox.confirm("此操作将删除该记录, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(f["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.$http.delete("install/result/".concat(e,"/"));case 2:if(n=a.sent,r=n.data,!r.code){a.next=6;break}return a.abrupt("return",t.$message.error(r.message));case 6:t.getList(),t.$message.success("记录已成功删除");case 8:case"end":return a.stop()}}),a)})))).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},toggleSelection:function(e){var t=this;e?e.forEach((function(e){t.$refs.multipleTable.toggleRowSelection(e)})):this.$refs.multipleTable.clearSelection()},handleSelectionChange:function(e){this.multipleSelection=e}}},se=re,ie=(a("51f4"),Object(l["a"])(se,ae,ne,!1,null,"3e8af026",null)),oe=ie.exports,le=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),a("el-breadcrumb-item",[e._v("模板管理")]),a("el-breadcrumb-item",[e._v("镜像模板")])],1),a("el-card",{staticClass:"box-card"},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:6}},[a("el-input",{attrs:{placeholder:"请输入内容"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},slot:"append"})],1)],1),a("el-col",{attrs:{span:12}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addImagedialogVisible=!0}}},[e._v("上传镜像")])],1)],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.imageList,border:""}},[a("el-table-column",{attrs:{type:"index",label:"序号",width:"50px"}}),a("el-table-column",{attrs:{prop:"name",label:"镜像名称"}}),a("el-table-column",{attrs:{prop:"type",label:"系统类型"}}),a("el-table-column",{attrs:{prop:"version",label:"版本"}}),a("el-table-column",{attrs:{prop:"path",label:"存储库位置",width:"600px"}}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"200px"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.openNewPage(n.path)}}},[e._v("查 看")]),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(t){return e.handleDel(n.id)}}},[e._v("删 除")])]}}])})],1),a("el-pagination",{attrs:{"current-page":e.pagination.page,"page-size":e.pagination.size,layout:"total, prev, pager, next, jumper",total:e.pagination.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),a("el-dialog",{attrs:{title:"提示",width:"35%",visible:e.addImagedialogVisible,"before-close":e.closeHandler},on:{"update:visible":function(t){e.addImagedialogVisible=t},close:function(t){return e.resetForm("addImages")}}},[a("el-form",{ref:"addImages",attrs:{model:e.addImageForm,rules:e.addImageRules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"镜像名称",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入镜像的名称"},model:{value:e.addImageForm.name,callback:function(t){e.$set(e.addImageForm,"name",t)},expression:"addImageForm.name"}})],1),a("el-form-item",{attrs:{label:"系统类型",prop:"type"}},[a("el-select",{attrs:{placeholder:"请选择系统类型"},model:{value:e.addImageForm.type,callback:function(t){e.$set(e.addImageForm,"type",t)},expression:"addImageForm.type"}},[a("el-option",{attrs:{label:"CentOS",value:"CentOS"}})],1)],1),a("el-form-item",{attrs:{label:"版本",prop:"version"}},[a("el-input",{attrs:{placeholder:"请输入镜像的发型版本"},model:{value:e.addImageForm.version,callback:function(t){e.$set(e.addImageForm,"version",t)},expression:"addImageForm.version"}})],1),a("el-form-item",{attrs:{label:"选择镜像",prop:"path"}},[a("el-input",{attrs:{placeholder:"请输入镜像的完整路径"},model:{value:e.addImageForm.path,callback:function(t){e.$set(e.addImageForm,"path",t)},expression:"addImageForm.path"}})],1),a("el-form-item",{attrs:{label:"解压镜像"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.extractImage(e.addImageForm)}}},[e._v("执行")])],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){return e.closeHandler()}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.handleAddImage}},[e._v("增加镜像")])],1)],1)],1)},ce=[],ue=(a("be4f"),a("450d"),a("896a")),de=a.n(ue),me={created:function(){this.getImageList()},data:function(){return{imageList:[],addImagedialogVisible:!1,addImageForm:{name:"",type:"",version:"",path:"",save_path:""},addImageRules:{name:[{required:!0,message:"请输入镜像名称",trigger:"blur"},{min:4,max:16,message:"长度在 4 到 16 个字符",trigger:"blur"}],type:[{required:!0,message:"请选择镜像类型",trigger:"change"}],version:[{required:!0,message:"请输入版本标识",trigger:"blur"},{min:4,max:16,message:"长度在 4 到 16 个字符",trigger:"blur"}],path:[{required:!0,message:"请上传镜像",trigger:"blur"}]},input3:"",fileList:[],imageTag:1,pagination:{page:1,size:20,total:0}}},methods:{openNewPage:function(e){window.open(e)},getImageList:function(e){var t=this;return Object(f["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e||(e=t.pagination.page),a.next=3,t.$http.get("temp/image/?page=".concat(e));case 3:if(n=a.sent,r=n.data,!r.code){a.next=7;break}return a.abrupt("return",t.$message.error(r.message));case 7:t.imageList=r.results,t.pagination=r.pagination;case 9:case"end":return a.stop()}}),a)})))()},handleSuccess:function(e,t,a){this.fileList=[e],this.addImageForm.path=this.fileList[0].url,this.addImageForm.save_path=this.fileList[0].save_path},handleRemove:function(e,t){this.fileList=[]},getHeaders:function(){return{Authorization:"Bearer ".concat(window.localStorage.getItem("token"))}},submitUpload:function(){this.$refs.upload.handleSuccess=this.handleSuccess,this.$refs.upload.submit()},extractImage:function(e){var t=this,a="addImages";this.$refs[a].validate(function(){var e=Object(f["a"])(regeneratorRuntime.mark((function e(a){var n,r,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!a){e.next=16;break}return n=de.a.service({lock:!0,text:"后台解压中...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.8)",target:document.querySelector(".el-dialog__body")}),e.next=4,t.$http.post("temp/extract/",t.addImageForm);case 4:if(r=e.sent,s=r.data,!s.code){e.next=9;break}return t.$nextTick((function(){n.close()})),e.abrupt("return",t.$message.error(s.message));case 9:t.addImageForm.path=s.url,t.addImageForm.save_path=s.save_path,t.imageTag=0,t.$nextTick((function(){n.close()})),t.$message.success("镜像解压成功！"),e.next=17;break;case 16:t.$message.error("验证失败，请重新输入");case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},handleAddImage:function(){var e=this,t="addImages";this.$refs[t].validate(function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(a){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.imageTag){t.next=2;break}return t.abrupt("return",e.$message.error("验证失败，请先解压镜像"));case 2:if(!a){t.next=15;break}return t.next=5,e.$http.post("temp/image/",e.addImageForm);case 5:if(n=t.sent,r=n.data,!r.code){t.next=9;break}return t.abrupt("return",e.$message.error(r.message));case 9:e.$message.success("镜像上传成功！"),e.addImagedialogVisible=!1,e.resetForm("addImages"),e.getImageList(),t.next=16;break;case 15:e.$message.error("验证失败，请重新输入");case 16:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},handleSizeChange:function(e){},handleCurrentChange:function(e){this.getImageList(e)},resetForm:function(e){this.$refs[e].resetFields(),this.fileList=[],this.imageTag=1},closeHandler:function(){var e=this;this.$msgbox.confirm("关闭窗口将会丢失已经上传的镜像, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.addImagedialogVisible=!1,e.resetForm("addImages"),e.$message.success("取消上传镜像")})).catch((function(){e.$message({type:"info",message:"已取消关闭窗口"})}))},handleDel:function(e){var t=this;this.$msgbox.confirm("此操作将删除该镜像, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(f["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.$http.delete("temp/image/".concat(e,"/"));case 2:if(n=a.sent,r=n.data,!r.code){a.next=6;break}return a.abrupt("return",t.$message.error(r.message));case 6:t.getImageList(t.pagination.page),t.$message.success("镜像已成功删除");case 8:case"end":return a.stop()}}),a)})))).catch((function(){t.$message({type:"info",message:"已取消删除"})}))}}},pe=me,fe=(a("eea9"),Object(l["a"])(pe,le,ce,!1,null,"f2160b62",null)),ge=fe.exports,be=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),a("el-breadcrumb-item",[e._v("模板管理")]),a("el-breadcrumb-item",[e._v("系统模板")])],1),a("el-card",{staticClass:"box-card"},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:6}},[a("el-input",{attrs:{placeholder:"请输入内容"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},slot:"append"})],1)],1),a("el-col",{attrs:{span:12}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addConfigDialogVisible=!0}}},[e._v("添加模板")])],1)],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.configList,border:""}},[a("el-table-column",{attrs:{type:"index",label:"序号",width:"50px"}}),a("el-table-column",{attrs:{prop:"name",label:"模板名称"}}),a("el-table-column",{attrs:{prop:"image",label:"关联镜像"}}),a("el-table-column",{attrs:{prop:"path",label:"文件位置"}}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"300px"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("el-button",{attrs:{type:"info",size:"small"},on:{click:function(t){return e.viewHandler(n)}}},[e._v("查看")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.editHandler(n)}}},[e._v("编辑")]),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(t){return e.handleDel(n.id)}}},[e._v("删除")])]}}])})],1),a("el-pagination",{attrs:{"current-page":e.pagination.page,"page-size":e.pagination.size,layout:"total, prev, pager, next, jumper",total:e.pagination.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),a("el-dialog",{attrs:{title:"增加模板",visible:e.addConfigDialogVisible,"before-close":e.closeHandler,width:"70%"},on:{"update:visible":function(t){e.addConfigDialogVisible=t},close:function(t){return e.resetForm("addConfig")}}},[a("el-form",{ref:"addConfig",attrs:{model:e.addConfigForm,rules:e.addConfigRules,"label-width":"100px",border:""}},[a("el-form-item",{attrs:{label:"模板名称",prop:"name"}},[a("el-input",{staticStyle:{width:"50%"},model:{value:e.addConfigForm.name,callback:function(t){e.$set(e.addConfigForm,"name",t)},expression:"addConfigForm.name"}})],1),a("el-form-item",{attrs:{label:"系统镜像",prop:"image"}},[a("el-select",{staticStyle:{width:"50%"},attrs:{placeholder:"请选择关联的系统镜像"},model:{value:e.addConfigForm.image,callback:function(t){e.$set(e.addConfigForm,"image",t)},expression:"addConfigForm.image"}},e._l(e.imageList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.name}})})),1)],1),a("el-form-item",{attrs:{label:"KS文件",prop:"config"}},[a("el-input",{attrs:{type:"textarea",rows:20},model:{value:e.addConfigForm.config,callback:function(t){e.$set(e.addConfigForm,"config",t)},expression:"addConfigForm.config"}})],1),a("el-form-item",{attrs:{label:"校准仓库地址"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.generateURL(e.addConfigForm)}}},[e._v("检查并修改 (必须)")])],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.addConfigDialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.addConfigHandler}},[e._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"查看模板",visible:e.viewConfigDialogVisible,width:"70%"},on:{"update:visible":function(t){e.viewConfigDialogVisible=t},close:function(t){return e.resetForm("viewConfig")}}},[a("el-form",{ref:"viewConfig",attrs:{model:e.viewConfigForm,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"模板名称"}},[a("el-input",{staticStyle:{width:"50%"},attrs:{disabled:""},model:{value:e.viewConfigForm.name,callback:function(t){e.$set(e.viewConfigForm,"name",t)},expression:"viewConfigForm.name"}})],1),a("el-form-item",{attrs:{label:"系统镜像"}},[a("el-input",{staticStyle:{width:"50%"},attrs:{disabled:""},model:{value:e.viewConfigForm.image,callback:function(t){e.$set(e.viewConfigForm,"image",t)},expression:"viewConfigForm.image"}})],1),a("el-form-item",{attrs:{label:"存储路径"}},[a("el-input",{staticStyle:{width:"50%"},attrs:{disabled:""},model:{value:e.viewConfigForm.path,callback:function(t){e.$set(e.viewConfigForm,"path",t)},expression:"viewConfigForm.path"}})],1),a("el-form-item",{attrs:{label:"KS文件"}},[a("el-input",{attrs:{type:"textarea",disabled:!0,rows:25},model:{value:e.viewConfigForm.config,callback:function(t){e.$set(e.viewConfigForm,"config",t)},expression:"viewConfigForm.config"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.viewConfigDialogVisible=!1}}},[e._v("关 闭")])],1)],1),a("el-dialog",{attrs:{title:"编辑模板",visible:e.editConfigDialogVisible,"before-close":e.closeHandler,width:"70%"},on:{"update:visible":function(t){e.editConfigDialogVisible=t},close:function(t){return e.resetForm("editConfig")}}},[a("el-form",{ref:"editConfig",attrs:{model:e.editConfigForm,rules:e.editConfigRules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"模板名称",prop:"name"}},[a("el-input",{staticStyle:{width:"50%"},attrs:{disabled:""},model:{value:e.editConfigForm.name,callback:function(t){e.$set(e.editConfigForm,"name",t)},expression:"editConfigForm.name"}})],1),a("el-form-item",{attrs:{label:"系统镜像",prop:"image"}},[a("el-input",{staticStyle:{width:"50%"},attrs:{disabled:""},model:{value:e.editConfigForm.image,callback:function(t){e.$set(e.editConfigForm,"image",t)},expression:"editConfigForm.image"}})],1),a("el-form-item",{attrs:{label:"存储路径"}},[a("el-input",{staticStyle:{width:"50%"},attrs:{disabled:""},model:{value:e.editConfigForm.path,callback:function(t){e.$set(e.editConfigForm,"path",t)},expression:"editConfigForm.path"}})],1),a("el-form-item",{attrs:{label:"KS文件",prop:"config"}},[a("el-input",{attrs:{type:"textarea",rows:20},model:{value:e.editConfigForm.config,callback:function(t){e.$set(e.editConfigForm,"config",t)},expression:"editConfigForm.config"}})],1),a("el-form-item",{attrs:{label:"校准仓库地址"}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.generateURL(e.editConfigForm)}}},[e._v("检查并修改 (必须)")])],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.editConfigDialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.editConfigHandler()}}},[e._v("确 定")])],1)],1)],1)},he=[],ve={created:function(){this.getConfigList(),this.getImageList()},data:function(){return{imageList:[],configList:[],addConfigDialogVisible:!1,addConfigForm:{name:"",image:"",config:"",path:"",save_path:""},addConfigRules:{name:[{required:!0,message:"请输入模板名称",trigger:"blur"},{min:4,max:16,message:"长度在 4 到 16 个字符",trigger:"blur"}],image:[{required:!0,message:"请选择系统镜像",trigger:"change"}],config:[{required:!0,message:"请输入配置参数",trigger:"blur"}]},checkTag:0,viewConfigDialogVisible:!1,viewConfigForm:{name:"",image:"",config:"",path:""},editConfigDialogVisible:!1,editConfigForm:{image:"",config:""},editConfigRules:{config:[{required:!0,message:"请输入配置参数",trigger:"blur"}]},pagination:{page:1,size:20,total:0}}},methods:{getImageList:function(){var e=this;return Object(f["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("temp/image/");case 2:if(a=t.sent,n=a.data,!n.code){t.next=6;break}return t.abrupt("return",e.$message.error(n.message));case 6:e.imageList=n.results;case 7:case"end":return t.stop()}}),t)})))()},handleSizeChange:function(e){},handleCurrentChange:function(e){this.getConfigList(e)},getConfigList:function(e){var t=this;return Object(f["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e||(e=t.pagination.page),a.next=3,t.$http.get("temp/config/?page=".concat(e));case 3:if(n=a.sent,r=n.data,!r.code){a.next=7;break}return a.abrupt("return",t.$message.error(r.message));case 7:t.configList=r.results,t.pagination=r.pagination;case 9:case"end":return a.stop()}}),a)})))()},addConfigHandler:function(){var e=this;if(!this.checkTag)return this.$message.error("请确保ks文件已经检查通过");var t="addConfig";this.$refs[t].validate(function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(a){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!a){t.next=13;break}return t.next=3,e.$http.post("temp/config/",e.addConfigForm);case 3:if(n=t.sent,r=n.data,!r.code){t.next=7;break}return t.abrupt("return",e.$message.error(r.message));case 7:e.$message.success("模板添加成功"),e.addConfigDialogVisible=!1,e.checkTag=0,e.getConfigList(),t.next=14;break;case 13:e.$message.error("验证失败，请检查内容！");case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},handleImageChange:function(){},generateURL:function(e){var t=this;return Object(f["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.$http.post("temp/config/generate/",e);case 2:if(n=a.sent,r=n.data,!r.code){a.next=6;break}return a.abrupt("return",t.$message.error(r.message));case 6:t.checkTag=1,t.$message.success("检查完成，已经替换URL"),e.config=r;case 9:case"end":return a.stop()}}),a)})))()},resetForm:function(e){this.$refs[e].resetFields()},viewHandler:function(e){this.viewConfigForm=e,this.viewConfigDialogVisible=!0},editHandler:function(e){this.editConfigForm=e,this.editConfigDialogVisible=!0},editConfigHandler:function(){var e=this;if(!this.checkTag)return this.$message.error("请确保ks文件已经检查通过");var t="editConfig";this.$refs[t].validate(function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(a){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!a){t.next=13;break}return t.next=3,e.$http.patch("temp/config/".concat(e.editConfigForm.id,"/"),e.editConfigForm);case 3:if(n=t.sent,r=n.data,!r.code){t.next=7;break}return t.abrupt("return",e.$message.error(r.message));case 7:e.$message.success("模板修改成功"),e.editConfigDialogVisible=!1,e.checkTag=0,e.getConfigList(),t.next=14;break;case 13:e.$message.error("验证失败，请检查内容！");case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},closeHandler:function(){var e=this;this.$msgbox.confirm("关闭窗口将会丢失当前内容, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.addConfigDialogVisible=!1,e.editConfigDialogVisible=!1,e.$message.success("关闭窗口成功")})).catch((function(){e.$message({type:"info",message:"已取消关闭窗口"})}))},handleDel:function(e){var t=this;this.$msgbox.confirm("此操作将删除该模板, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(f["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.$http.delete("temp/config/".concat(e,"/"));case 2:if(n=a.sent,r=n.data,!r.code){a.next=6;break}return a.abrupt("return",t.$message.error(r.message));case 6:t.getConfigList(),t.$message.success("模板已成功删除");case 8:case"end":return a.stop()}}),a)})))).catch((function(){t.$message({type:"info",message:"已取消删除"})}))}}},we=ve,xe=(a("dea4"),Object(l["a"])(we,be,he,!1,null,"d3208b7e",null)),ye=xe.exports,ke=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),a("el-breadcrumb-item",[e._v("模板管理")]),a("el-breadcrumb-item",[e._v("硬件模板")])],1),a("el-card",{staticClass:"box-card"},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:6}},[a("el-input",{attrs:{placeholder:"请输入内容"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},slot:"append"})],1)],1),a("el-col",{attrs:{span:12}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addHwdialogVisible=!0}}},[e._v("增加模板")])],1)],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.hwList,border:""}},[a("el-table-column",{attrs:{prop:"name",label:"硬件名称"}}),a("el-table-column",{attrs:{prop:"vendor",label:"服务器厂商"}}),a("el-table-column",{attrs:{prop:"model",label:"产品型号"}}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"200px"}},[[a("el-button",{attrs:{type:"info",size:"small"},on:{click:function(t){e.addHwdialogVisible=!0}}},[e._v("详细信息")]),a("el-button",{attrs:{type:"danger",size:"small"}},[e._v("删除")])]],2)],1),a("el-pagination",{attrs:{"current-page":e.pagination.page,"page-size":e.pagination.size,layout:"total, prev, pager, next, jumper",total:e.pagination.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),a("el-dialog",{attrs:{title:"提示",visible:e.addHwdialogVisible},on:{"update:visible":function(t){e.addHwdialogVisible=t},close:function(t){return e.resetForm("addHw")}}},[a("el-form",{ref:"addHw",attrs:{model:e.addHwForm,rules:e.addUserRules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"硬件名称",prop:"name"}},[a("el-input",{model:{value:e.addHwForm.name,callback:function(t){e.$set(e.addHwForm,"name",t)},expression:"addHwForm.name"}})],1),a("el-form-item",{attrs:{label:"服务器厂商",prop:"vendor"}},[a("el-input",{model:{value:e.addHwForm.vendor,callback:function(t){e.$set(e.addHwForm,"vendor",t)},expression:"addHwForm.vendor"}})],1),a("el-form-item",{attrs:{label:"产品型号",prop:"model"}},[a("el-input",{model:{value:e.addHwForm.model,callback:function(t){e.$set(e.addHwForm,"model",t)},expression:"addHwForm.model"}})],1),a("el-form-item",{attrs:{label:"RAID",prop:"raid"}},[a("el-table",{attrs:{data:e.addHwForm.raid,border:""}},[a("el-table-column",{attrs:{prop:"model",label:"模式"}}),a("el-table-column",{attrs:{prop:"disks",label:"硬盘选择"}}),a("el-table-column",{attrs:{prop:"info",label:"备注"}})],1)],1),a("el-form-item",{attrs:{label:"IPMI",prop:"ipmi"}},[a("el-table",{attrs:{data:e.addHwForm.ipmi,border:""}},[a("el-table-column",{attrs:{prop:"ipaddr",label:"网络配置"}}),a("el-table-column",{attrs:{prop:"username",label:"用户名"}}),a("el-table-column",{attrs:{prop:"password",label:"密码"}})],1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.addHwdialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"}},[e._v("确定")])],1)],1)],1)},_e=[],Ce={created:function(){this.getUserList()},data:function(){return{addHwdialogVisible:!1,addHwForm:{name:"",vendor:"",model:"",raid:[{model:"RAID_1",disks:"0 1",info:"系统盘"},{model:"RAID_5",disks:"2 3 4 , 5",info:"数据盘，5是热备"}],ipmi:[{ipaddr:"static",username:"root",password:"calvin"}]},input3:"",hwList:[{name:"Dell-R740-Hadoop",vendor:"Dell",model:"R740"},{name:"Huawei-RH2288HV3-Hadoop",vendor:"Huawei",model:"RH2288H_V3"},{name:"VM-Test",vendor:"VM",model:"虚拟机"}],pagination:{page:1,size:20,total:0}}},methods:{getUserList:function(){var e=arguments,t=this;return Object(f["a"])(regeneratorRuntime.mark((function a(){var n,r,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=e.length>0&&void 0!==e[0]?e[0]:1,n||(n=1),a.next=4,t.$http.get("users/?page=".concat(n));case 4:if(r=a.sent,s=r.data,!s.code){a.next=8;break}return a.abrupt("return",t.$message.error(s.message));case 8:t.userList=s.results,t.pagination=s.pagination;case 10:case"end":return a.stop()}}),a)})))()},handleSizeChange:function(e){},handleCurrentChange:function(e){this.getUserList(e)},resetForm:function(e){this.$refs[e].resetFields()},addUser:function(){var e=this,t="addUser";this.$refs[t].validate(function(){var a=Object(f["a"])(regeneratorRuntime.mark((function a(n){var r,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!n){a.next=13;break}return a.next=3,e.$http.post("users/",e.addImageForm);case 3:if(r=a.sent,s=r.data,!s.code){a.next=7;break}return a.abrupt("return",e.$message.error(s.message));case 7:e.$message.success("用户添加成功！"),e.addHwdialogVisible=!1,e.resetForm(t),e.getUserList(),a.next=14;break;case 13:e.$message.error("验证失败，请重新输入");case 14:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}())}}},$e=Ce,je=Object(l["a"])($e,ke,_e,!1,null,"5c6b6562",null),Fe=je.exports,Ie=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),a("el-breadcrumb-item",[e._v("任务管理")]),a("el-breadcrumb-item",[e._v("任务模板")])],1),a("el-card",{staticClass:"box-card"},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:6}},[a("el-input",{attrs:{placeholder:"请输入内容"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},slot:"append"})],1)],1),a("el-col",{attrs:{span:12}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addConfigDialogVisible=!0}}},[e._v("添加模板")])],1)],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.configList,border:""}},[a("el-table-column",{attrs:{type:"index",label:"序号",width:"50px"}}),a("el-table-column",{attrs:{prop:"name",label:"模板名称"}}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"300px"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("el-button",{attrs:{type:"info",size:"small"},on:{click:function(t){return e.viewHandler(n)}}},[e._v("查看")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.editHandler(n)}}},[e._v("编辑")]),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(t){return e.handleDel(n.id)}}},[e._v("删除")])]}}])})],1),a("el-pagination",{attrs:{"current-page":e.pagination.page,"page-size":e.pagination.size,layout:"total, prev, pager, next, jumper",total:e.pagination.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),a("el-dialog",{attrs:{title:"增加模板",visible:e.addConfigDialogVisible,"before-close":e.closeHandler,width:"70%"},on:{"update:visible":function(t){e.addConfigDialogVisible=t},close:function(t){return e.resetForm("addConfig")}}},[a("el-form",{ref:"addConfig",attrs:{model:e.addConfigForm,rules:e.addConfigRules,"label-width":"100px",border:""}},[a("el-form-item",{attrs:{label:"模板名称",prop:"name"}},[a("el-input",{staticStyle:{width:"50%"},model:{value:e.addConfigForm.name,callback:function(t){e.$set(e.addConfigForm,"name",t)},expression:"addConfigForm.name"}})],1),a("el-form-item",{attrs:{label:"Playbook",prop:"content"}},[a("el-input",{attrs:{type:"textarea",rows:20},model:{value:e.addConfigForm.content,callback:function(t){e.$set(e.addConfigForm,"content",t)},expression:"addConfigForm.content"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.addConfigDialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.addConfigHandler}},[e._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"查看模板",visible:e.viewConfigDialogVisible,width:"70%"},on:{"update:visible":function(t){e.viewConfigDialogVisible=t},close:function(t){return e.resetForm("viewConfig")}}},[a("el-form",{ref:"viewConfig",attrs:{model:e.viewConfigForm,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"模板名称"}},[a("el-input",{staticStyle:{width:"50%"},attrs:{disabled:""},model:{value:e.viewConfigForm.name,callback:function(t){e.$set(e.viewConfigForm,"name",t)},expression:"viewConfigForm.name"}})],1),a("el-form-item",{attrs:{label:"Playbook"}},[a("el-input",{attrs:{type:"textarea",disabled:!0,rows:25},model:{value:e.viewConfigForm.content,callback:function(t){e.$set(e.viewConfigForm,"content",t)},expression:"viewConfigForm.content"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.viewConfigDialogVisible=!1}}},[e._v("关 闭")])],1)],1),a("el-dialog",{attrs:{title:"编辑模板",visible:e.editConfigDialogVisible,"before-close":e.closeHandler,width:"70%"},on:{"update:visible":function(t){e.editConfigDialogVisible=t},close:function(t){return e.resetForm("editConfig")}}},[a("el-form",{ref:"editConfig",attrs:{model:e.editConfigForm,rules:e.editConfigRules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"模板名称",prop:"name"}},[a("el-input",{staticStyle:{width:"50%"},attrs:{disabled:""},model:{value:e.editConfigForm.name,callback:function(t){e.$set(e.editConfigForm,"name",t)},expression:"editConfigForm.name"}})],1),a("el-form-item",{attrs:{label:"Playbook",prop:"content"}},[a("el-input",{attrs:{type:"textarea",rows:20},model:{value:e.editConfigForm.content,callback:function(t){e.$set(e.editConfigForm,"content",t)},expression:"editConfigForm.content"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.editConfigDialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.editConfigHandler()}}},[e._v("确 定")])],1)],1)],1)},Se=[],Re={created:function(){this.getConfigList()},data:function(){return{imageList:[],configList:[],addConfigDialogVisible:!1,addConfigForm:{name:"",content:""},addConfigRules:{name:[{required:!0,message:"请输入模板名称",trigger:"blur"},{min:4,max:16,message:"长度在 4 到 16 个字符",trigger:"blur"}],content:[{required:!0,message:"请输入playbook",trigger:"blur"}]},checkTag:0,viewConfigDialogVisible:!1,viewConfigForm:{name:"",content:""},editConfigDialogVisible:!1,editConfigForm:{name:"",content:""},editConfigRules:{content:[{required:!0,message:"请输入配置参数",trigger:"blur"}]},pagination:{page:1,size:5,total:0}}},methods:{handleSizeChange:function(e){},handleCurrentChange:function(e){this.getConfigList(e)},getConfigList:function(e){var t=this;return Object(f["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e||(e=t.pagination.page),a.next=3,t.$http.get("task/template/?page=".concat(e));case 3:if(n=a.sent,r=n.data,!r.code){a.next=7;break}return a.abrupt("return",t.$message.error(r.message));case 7:t.configList=r.results,t.pagination=r.pagination;case 9:case"end":return a.stop()}}),a)})))()},addConfigHandler:function(){var e=this,t="addConfig";this.$refs[t].validate(function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(a){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!a){t.next=13;break}return t.next=3,e.$http.post("task/template/",e.addConfigForm);case 3:if(n=t.sent,r=n.data,!r.code){t.next=7;break}return t.abrupt("return",e.$message.error(r.message));case 7:e.$message.success("模板添加成功"),e.addConfigDialogVisible=!1,e.checkTag=0,e.getConfigList(),t.next=14;break;case 13:e.$message.error("验证失败，请检查内容！");case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},handleImageChange:function(){},resetForm:function(e){this.$refs[e].resetFields()},viewHandler:function(e){this.viewConfigForm=e,this.viewConfigDialogVisible=!0},editHandler:function(e){this.editConfigForm=e,this.editConfigDialogVisible=!0},editConfigHandler:function(){var e=this,t="editConfig";this.$refs[t].validate(function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(a){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!a){t.next=12;break}return t.next=3,e.$http.patch("task/template/".concat(e.editConfigForm.id,"/"),e.editConfigForm);case 3:if(n=t.sent,r=n.data,!r.code){t.next=7;break}return t.abrupt("return",e.$message.error(r.message));case 7:e.$message.success("模板修改成功"),e.editConfigDialogVisible=!1,e.getConfigList(),t.next=13;break;case 12:e.$message.error("验证失败，请检查内容！");case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},closeHandler:function(){var e=this;this.$msgbox.confirm("关闭窗口将会丢失当前内容, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.addConfigDialogVisible=!1,e.editConfigDialogVisible=!1,e.$message.success("关闭窗口成功")})).catch((function(){e.$message({type:"info",message:"已取消关闭窗口"})}))},handleDel:function(e){var t=this;this.$msgbox.confirm("此操作将删除该模板, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(f["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.$http.delete("task/template/".concat(e,"/"));case 2:if(n=a.sent,r=n.data,!r.code){a.next=6;break}return a.abrupt("return",t.$message.error(r.message));case 6:t.getConfigList(),t.$message.success("模板已成功删除");case 8:case"end":return a.stop()}}),a)})))).catch((function(){t.$message({type:"info",message:"已取消删除"})}))}}},Le=Re,ze=(a("6ed5c"),Object(l["a"])(Le,Ie,Se,!1,null,"3f30137e",null)),Oe=ze.exports,De=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),a("el-breadcrumb-item",[e._v("任务管理")]),a("el-breadcrumb-item",[e._v("主机列表")])],1),a("el-card",{staticClass:"box-card"},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:6}},[a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},slot:"append"})],1)],1),a("el-col",{attrs:{span:2}},[a("el-button",{attrs:{type:"success"},on:{click:function(t){return e.getHostList()}}},[e._v("手动刷新")])],1)],1),a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.hostList,border:"","row-key":"mac"},on:{select:e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection","reserve-selection":!0,width:"45"}}),a("el-table-column",{attrs:{type:"index",label:"ID"}}),a("el-table-column",{attrs:{prop:"sn",label:"SN",width:"180"}}),a("el-table-column",{attrs:{prop:"vender",label:"生厂商"}}),a("el-table-column",{attrs:{prop:"product",label:"产品型号"}}),a("el-table-column",{attrs:{prop:"clientip",label:"Client IP"}}),a("el-table-column",{attrs:{prop:"ipmi",label:"IPMI IP"}}),a("el-table-column",{attrs:{prop:"join_date",label:"加入时间",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(" "+e._s(e._f("dateFmt")(n.join_date)))])]}}])}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"280px"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.handleCommand(n)}}},[e._v("运行命令")]),a("el-button",{attrs:{type:"success",size:"small"},on:{click:function(t){return e.handlePlaybook(n)}}},[e._v("执行模板")]),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(t){return e.handleDel(n)}}},[e._v("删除")])]}}])})],1),a("el-pagination",{attrs:{"current-page":e.pagination.page,"page-size":e.pagination.size,layout:"total, prev, pager, next, jumper",total:e.pagination.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),a("div",{staticStyle:{"margin-top":"20px"}},[a("el-button",{attrs:{type:"success",size:"small"},on:{click:function(t){return e.handleInstall()}}},[e._v("更改到装机列表")]),a("el-button",{attrs:{type:"danger",size:"small",disabled:""}},[e._v("关机")])],1),a("div",{staticClass:"info"},[a("h2",[e._v("这里可以对进入BootOS的主机执行任务")]),a("h2",[e._v("任务包含： ansible模块， playbook")]),a("h2",[e._v("执行任务完成后，依然可以转到安装列表中")]),a("h2",[e._v("命令的执行可以在当前窗口直接获取结果")]),a("h2",[e._v("模板的执行可以需要在记录中查看")])])],1),a("el-dialog",{attrs:{title:"执行命令",visible:e.commandDialogFormVisible,"before-close":e.closeHandler},on:{"update:visible":function(t){e.commandDialogFormVisible=t},close:function(t){return e.resetForm("command")}}},[a("el-form",{ref:"command",attrs:{model:e.commandForm,rules:e.commandRules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"当前设备"}},[e._v(" "+e._s(e.commandForm.sn)+" ")]),a("el-form-item",{attrs:{label:"模块",prop:"model"}},[a("el-input",{staticStyle:{width:"50%"},attrs:{placeholder:"请输入模块名称"},model:{value:e.commandForm.model,callback:function(t){e.$set(e.commandForm,"model",t)},expression:"commandForm.model"}})],1),a("el-form-item",{attrs:{label:"参数",prop:"args"}},[a("el-input",{staticStyle:{width:"50%"},attrs:{placeholder:"请输入模块参数"},model:{value:e.commandForm.args,callback:function(t){e.$set(e.commandForm,"args",t)},expression:"commandForm.args"}}),a("div",{staticStyle:{"margin-top":"20px"}},[a("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.clear()}}},[e._v("清空显示框")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitCommand()}}},[e._v(e._s(e.loadingtext))])],1)],1)],1),a("div",{staticClass:"console"},e._l(e.outputList,(function(t,n){return a("div",{key:n,staticClass:"output",attrs:{id:"output"}},[a("p",{domProps:{innerHTML:e._s(t)}})])})),0),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"danger"},on:{click:function(t){e.commandDialogFormVisible=!1}}},[e._v("关 闭")])],1)],1),a("el-dialog",{attrs:{title:"选择模板",visible:e.templateDialogVisible,"before-close":e.closeHandler,width:"30%"},on:{"update:visible":function(t){e.templateDialogVisible=t},close:function(t){return e.resetForm("template")}}},[a("el-form",{ref:"template",attrs:{model:e.templateForm,rules:e.templateRules,"label-width":"100px",border:""}},[a("el-form-item",{attrs:{label:"当前设备"}},[e._v(" "+e._s(e.templateForm.sn)+" ")]),a("el-form-item",{attrs:{label:"模板名称",prop:"tempid"}},[a("el-select",{staticStyle:{width:"50%"},attrs:{placeholder:"请选择即将运行的模板"},model:{value:e.templateForm.tempid,callback:function(t){e.$set(e.templateForm,"tempid",t)},expression:"templateForm.tempid"}},e._l(e.templateList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.templateDialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitPlaybook()}}},[e._v("发送任务")])],1)],1)],1)},He=[],Te=a("1386"),Ve=a.n(Te),Pe={created:function(){this.getHostList(),this.getTemplateList()},data:function(){return{loadingbutton:!1,loadingtext:"发送并执行",hostList:[],multipleSelection:[],selectArray:[],search:null,pagination:{page:1,size:20,total:0},outputList:[],commandDialogFormVisible:!1,commandForm:{sn:"",mac:"",model:"",args:""},commandRules:{model:[{required:!0,message:"请输入模块名称",trigger:"blur"}]},templateList:[],templateForm:{sn:"",mac:"",tempid:""},templateDialogVisible:!1,templateRules:{tempid:[{required:!0,message:"请选择模板",trigger:"change"}]}}},methods:{getTemplateList:function(){var e=this;return Object(f["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("task/template/");case 2:if(a=t.sent,n=a.data,!n.code){t.next=6;break}return t.abrupt("return",e.$message.error(n.message));case 6:e.templateList=n.results;case 7:case"end":return t.stop()}}),t)})))()},resetForm:function(e){this.$refs[e].resetFields(),this.multipleSelection=[],this.outputList=[]},handleSizeChange:function(e){},handleCurrentChange:function(e){this.getHostList(e)},getHostList:function(e){var t=this;return Object(f["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e||(e=t.pagination.page),a.next=3,t.$http.get("task/hostlist/?page=".concat(e));case 3:if(n=a.sent,r=n.data,!r.code){a.next=7;break}return a.abrupt("return",t.$message.error(r.message));case 7:t.hostList=r.results,t.pagination=r.pagination;case 9:case"end":return a.stop()}}),a)})))()},handleSelectionChange:function(e){this.multipleSelection=e},handleCommand:function(e){this.commandForm.sn=e.sn,this.commandForm.mac=e.mac,this.commandDialogFormVisible=!0},submitCommand:function(){var e=this;this.loadingbutton="运行中...";var t="command";this.$refs[t].validate(function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(a){var n,r,s,i,o,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!a){t.next=19;break}return n=de.a.service({lock:!0,text:"运行中...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.8)",target:document.querySelector(".el-dialog__body")}),t.next=4,e.$http.post("task/hostlist/".concat(e.commandForm.mac,"/command/"),e.commandForm);case 4:if(r=t.sent,s=r.data,!s.code){t.next=9;break}return e.$nextTick((function(){n.close()})),t.abrupt("return",e.$message.error(s.message));case 9:e.$message.success("命令提交成功"),i=new Ve.a,o=s,l=i.ansi_to_html(o),e.outputList.push(l),e.$nextTick((function(){n.close()})),e.loadingbutton=!1,e.loadingtext="提交并运行",t.next=21;break;case 19:e.fullscreenLoading=!1,e.$message.error("验证失败，请检查内容！");case 21:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},closeHandler:function(){var e=this;this.$msgbox.confirm("关闭窗口将会丢失当前内容, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.commandDialogFormVisible=!1,e.$message.success("关闭窗口成功")})).catch((function(){e.$message({type:"info",message:"已取消关闭窗口"})}))},clear:function(){this.outputList=[]},handleEdit:function(e){this.editHostForm=e,this.editDialogFormVisible=!0},getConfigList:function(){var e=this;return Object(f["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("temp/config/");case 2:if(a=t.sent,n=a.data,!n.code){t.next=6;break}return t.abrupt("return",e.$message.error(n.message));case 6:e.configList=n.results;case 7:case"end":return t.stop()}}),t)})))()},handlePlaybook:function(e){this.templateForm.sn=e.sn,this.templateForm.mac=e.mac,this.templateDialogVisible=!0},submitPlaybook:function(){var e=this,t="template";this.$refs[t].validate(function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(a){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!a){t.next=12;break}return t.next=3,e.$http.post("task/hostlist/".concat(e.templateForm.mac,"/playbook/"),e.templateForm);case 3:if(n=t.sent,r=n.data,!r.code){t.next=7;break}return t.abrupt("return",e.$message.error(r.message));case 7:e.templateDialogVisible=!1,e.getHostList(e.pagination.page),e.$message.success(r),t.next=13;break;case 12:e.$message.error("验证失败，请检查内容！");case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},editHost:function(){var e=this,t="editHost";this.$refs[t].validate(function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(a){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!a){t.next=12;break}return t.next=3,e.$http.patch("install/iprelist/".concat(e.editHostForm.mac,"/"),e.editHostForm);case 3:if(n=t.sent,r=n.data,!r.code){t.next=7;break}return t.abrupt("return",e.$message.error(r.message));case 7:e.editDialogFormVisible=!1,e.getHostList(e.pagination.page),e.$message.success("配置成功"),t.next=13;break;case 12:e.$message.error("验证失败，请检查内容！");case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},handleDelete:function(){},handlePxeboot:function(){},handleDel:function(e){var t=this;this.$msgbox.confirm("此操作将删除该设备, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(f["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.$http.delete("task/hostlist/".concat(e.mac,"/"));case 2:if(n=a.sent,r=n.data,!r.code){a.next=6;break}return a.abrupt("return",t.$message.error(r.message));case 6:t.getHostList(t.pagination.page),t.$message.success("设备"+e.sn+" 已成功删除");case 8:case"end":return a.stop()}}),a)})))).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},toggleSelection:function(e){var t=this;e?e.forEach((function(e){t.$refs.multipleTable.toggleRowSelection(e)})):this.$refs.multipleTable.clearSelection()},handleInstall:function(){var e=this;0!==this.$refs.multipleTable.selection.length?this.$refs.multipleTable.selection.forEach(function(){var t=Object(f["a"])(regeneratorRuntime.mark((function t(a){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.post("/task/hostlist/".concat(a.mac,"/convert/"));case 2:if(n=t.sent,r=n.data,!r.code){t.next=6;break}return t.abrupt("return",e.$message.error(r.message));case 6:e.$message.success("".concat(a.mac,"已经成功添加到装机列表")),e.$refs.multipleTable.selection.shift(),e.getHostList();case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()):this.$message.error("当前未选中任何设备")}}},Ee=Pe,Me=(a("1fc8"),Object(l["a"])(Ee,De,He,!1,null,"b957519c",null)),Ue=Me.exports,Be=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),a("el-breadcrumb-item",[e._v("任务管理")]),a("el-breadcrumb-item",[e._v("执行结果")])],1),a("el-card",{staticClass:"box-card"},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:6}},[a("el-input",{attrs:{placeholder:"请输入内容"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},slot:"append"})],1)],1),a("el-col",{attrs:{span:2}},[a("el-button",{attrs:{type:"success"},on:{click:function(t){return e.getList()}}},[e._v("手动刷新")])],1),a("el-col",{attrs:{span:3}},[a("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.cycleRunFunc(0,e.getList)}}},[e._v("停止自动刷新")])],1)],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:""},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"45"}}),a("el-table-column",{attrs:{type:"index",label:"ID"}}),a("el-table-column",{attrs:{prop:"name",label:"SN",width:"180px"}}),a("el-table-column",{attrs:{prop:"playbook",label:"运行模板"}}),a("el-table-column",{attrs:{prop:"task_id",label:"任务ID"}}),a("el-table-column",{attrs:{prop:"date",label:"开始时间",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("span",[e._v(" "+e._s(e._f("dateFmt")(n.date)))])]}}])}),a("el-table-column",{attrs:{prop:"status",label:"任务状态",width:"100",filters:[{text:"正在运行中",value:1},{text:"任务结束",value:0}],"filter-method":e.filterTag,"filter-placement":"bottom-end"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("el-tag",{attrs:{type:n.status?"primary":"danger","disable-transitions":""}},[e._v(e._s(n.status?"Running":"Done"))])]}}])}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"200px"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("el-button",{attrs:{type:"info",size:"small"},on:{click:function(t){return e.handleInfo(n)}}},[e._v("任务详情")]),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(t){return e.handleDel(n.id)}}},[e._v("删除")])]}}])})],1),a("el-pagination",{attrs:{"current-page":e.pagination.page,"page-size":e.pagination.size,layout:"total, prev, pager, next, jumper",total:e.pagination.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),a("div",{staticStyle:{"margin-top":"20px"}},[a("el-button",{attrs:{type:"info",size:"small",disabled:""}},[e._v("信息导出")])],1)],1),a("el-drawer",{ref:"drawer",attrs:{title:e.tempInfoObj.name+" 的详细信息","before-close":e.handleClose,visible:e.dialog,direction:"rtl",size:"70%","custom-class":"demo-drawer",border:!0},on:{"update:visible":function(t){e.dialog=t}}},[a("div",{staticClass:"demo-drawer__content"},[a("el-descriptions",{staticClass:"margin-top",attrs:{title:"任务详情",column:1,border:"",size:"small"}},[a("el-descriptions-item",{attrs:{label:"当前状态"}},[a("el-steps",{attrs:{space:200,active:parseInt(e.tempInfoObj.progress),"finish-status":"success"}},[a("el-step",{attrs:{title:"任务开始"}}),a("el-step",{attrs:{title:"执行中"}}),a("el-step",{attrs:{title:"任务结束"}})],1)],1),a("el-descriptions-item",{attrs:{label:"实时日志"}},[a("div",{staticClass:"console"},e._l(e.outputList,(function(t,n){return a("div",{key:n,staticClass:"output",attrs:{id:"output"}},[a("p",{domProps:{innerHTML:e._s(t)}})])})),0)])],1),a("div",{staticClass:"demo-drawer__footer"})],1)])],1)},qe=[],Ae={created:function(){this.getList(),this.cycleRunFunc(1,this.getList,5e3)},beforeDestroy:function(){for(var e in this.timerManager)clearInterval(this.timerManager[e])},data:function(){return{pagination:{page:1,size:20,total:0},table:!1,dialog:!1,loading:!1,formLabelWidth:"200px",timer:null,size:"",outputList:[],tempInfoObj:{name:"",progress:"",result:"",taskid:""},tableData:[],whileTag:1,intervalID:null,timerManager:{}}},methods:{getList:function(e){var t=this;return Object(f["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e||(e=t.pagination.page),a.next=3,t.$http.get("task/result/?page=".concat(e));case 3:if(n=a.sent,r=n.data,!r.code){a.next=7;break}return a.abrupt("return",t.$message.error(r.message));case 7:t.tableData=r.results,t.pagination=r.pagination;case 9:case"end":return a.stop()}}),a)})))()},filterTag:function(e,t){return t.status===e},filterHandler:function(e,t,a){var n=a.property;return t[n]===e},handleSizeChange:function(e){},handleCurrentChange:function(e){this.getList(e)},handleClose:function(){this.getList(),this.dialog=!1,this.cycleRunFunc(0,this.getRunningResult),this.tempInfoObj={name:"",progress:"",result:"",taskid:""},this.outputList=[]},cycleRunFunc:function(e,t,a){var n=t.name;if(e){this.$message.success("自动刷新已经开始");var r=setInterval(t,a);this.timerManager[n]=r}else{var s=this.timerManager[n];clearInterval(s),this.timerManager[n]=void 0,this.$message.success("已停止自动刷新")}},handleInfo:function(e){if(e.status)this.dialog=!0,this.tempInfoObj.taskid=e.task_id,this.tempInfoObj.progress=e.progress,this.cycleRunFunc(1,this.getRunningResult,3e3);else{this.tempInfoObj=e;var t=new Ve.a,a=e.result,n=t.ansi_to_html(a);this.outputList.push(n),this.dialog=!0}},getRunningResult:function(){var e=this;return Object(f["a"])(regeneratorRuntime.mark((function t(){var a,n,r,s,i,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.outputList=[],a=e.tempInfoObj.taskid,t.next=4,e.$http.get("task/result/running/?taskid=".concat(a));case 4:if(n=t.sent,r=n.data,!r.code){t.next=11;break}if(888!==r.code){t.next=10;break}return e.cycleRunFunc(0,e.getRunningResult),t.abrupt("return",e.$message.error(r.message));case 10:return t.abrupt("return",e.$message.error(r.message));case 11:s=new Ve.a,i=r,o=s.ansi_to_html(i),e.outputList.push(o);case 15:case"end":return t.stop()}}),t)})))()},handlePxeboot:function(){},handleDel:function(e){var t=this;this.$msgbox.confirm("此操作将删除该记录, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(f["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.$http.delete("task/result/".concat(e,"/"));case 2:if(n=a.sent,r=n.data,!r.code){a.next=6;break}return a.abrupt("return",t.$message.error(r.message));case 6:t.getList(),t.$message.success("记录已成功删除");case 8:case"end":return a.stop()}}),a)})))).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},toggleSelection:function(e){var t=this;e?e.forEach((function(e){t.$refs.multipleTable.toggleRowSelection(e)})):this.$refs.multipleTable.clearSelection()},handleSelectionChange:function(e){this.multipleSelection=e}}},Ne=Ae,Ge=(a("e6c2"),Object(l["a"])(Ne,Be,qe,!1,null,"5d808619",null)),Je=Ge.exports;n["default"].use(d["a"]);var Ke=[{path:"/",redirect:"/home"},{path:"/login",component:v},{path:"/home",component:C,redirect:"/dashboard",children:[{path:"/dashboard",component:L},{path:"/discovered",component:V},{path:"/presettings",component:q},{path:"/prelist",component:W},{path:"/installing",component:te},{path:"/installed",component:oe},{path:"/images",component:ge},{path:"/ostemps",component:ye},{path:"/hwtemps",component:Fe},{path:"/hostlist",component:Ue},{path:"/tasktemps",component:Oe},{path:"/taskresult",component:Je}]}],We=new d["a"]({routes:Ke});We.beforeEach((function(e,t,a){if("/login"===e.path)a();else{var n=window.localStorage.getItem("token");n?a():a("/login")}}));var Xe=We,Qe=(a("9e1f"),a("6ed5")),Ye=a.n(Qe),Ze=(a("0fb7"),a("f529")),et=a.n(Ze),tt=(a("b5d8"),a("f494")),at=a.n(tt),nt=(a("6611"),a("e772")),rt=a.n(nt),st=(a("826b"),a("c263")),it=a.n(st),ot=(a("4ffc"),a("946e")),lt=a.n(ot),ct=(a("e960"),a("b35b")),ut=a.n(ct),dt=(a("d4df"),a("7fc1")),mt=a.n(dt),pt=(a("560b"),a("dcdc")),ft=a.n(pt),gt=(a("d96c"),a("0c9b")),bt=a.n(gt),ht=(a("fb08"),a("21e5")),vt=a.n(ht),wt=(a("0fb4"),a("9944")),xt=a.n(wt),yt=(a("f225"),a("89a9")),kt=a.n(yt),_t=(a("672e"),a("101e")),Ct=a.n(_t),$t=(a("a7cc"),a("df33")),jt=a.n($t),Ft=(a("f4f9"),a("c2cc")),It=a.n(Ft),St=(a("7a0f"),a("0f6c")),Rt=a.n(St),Lt=(a("5466"),a("ecdf")),zt=a.n(Lt),Ot=(a("38a0"),a("ad41")),Dt=a.n(Ot),Ht=(a("b8e0"),a("a4c4")),Tt=a.n(Ht),Vt=(a("b84d"),a("c216")),Pt=a.n(Vt),Et=(a("8f24"),a("76b9")),Mt=a.n(Et),Ut=(a("4ca3"),a("443e")),Bt=a.n(Ut),qt=(a("8bd8"),a("4cb2")),At=a.n(qt),Nt=(a("ce18"),a("f58e")),Gt=a.n(Nt),Jt=(a("a769"),a("5cc3")),Kt=a.n(Jt),Wt=(a("de31"),a("c69e")),Xt=a.n(Wt),Qt=(a("a673"),a("7b31")),Yt=a.n(Qt),Zt=(a("adec"),a("3d2d")),ea=a.n(Zt),ta=(a("10cb"),a("f3ad")),aa=a.n(ta),na=(a("eca7"),a("3787")),ra=a.n(na),sa=(a("425f"),a("4105")),ia=a.n(sa),oa=(a("1951"),a("eedf")),la=a.n(oa),ca=(a("fe07"),a("6ac5")),ua=a.n(ca),da=(a("34db"),a("3803")),ma=a.n(da),pa=(a("1f1a"),a("4e4b")),fa=a.n(pa),ga=(a("6b30"),a("c284")),ba=a.n(ga),ha=(a("d2ac"),a("95b0")),va=a.n(ha),wa=(a("9c49"),a("6640")),xa=a.n(wa),ya=(a("cbb5"),a("8bbc")),ka=a.n(ya),_a=(a("cb70"),a("b370")),Ca=a.n(_a),$a=(a("960d"),a("defb")),ja=a.n($a),Fa=(a("bd49"),a("18ff")),Ia=a.n(Fa),Sa=(a("06f1"),a("6ac9")),Ra=a.n(Sa),La=(a("fd71"),a("a447")),za=a.n(La);a("0fae");n["default"].use(za.a),n["default"].use(Ra.a),n["default"].use(Ia.a),n["default"].use(ja.a),n["default"].use(Ca.a),n["default"].use(ka.a),n["default"].use(xa.a),n["default"].use(va.a),n["default"].use(ba.a),n["default"].use(fa.a),n["default"].use(ma.a),n["default"].use(ua.a),n["default"].use(la.a),n["default"].use(ia.a),n["default"].use(ra.a),n["default"].use(aa.a),n["default"].use(ea.a),n["default"].use(Yt.a),n["default"].use(Xt.a),n["default"].use(Kt.a),n["default"].use(Gt.a),n["default"].use(At.a),n["default"].use(Bt.a),n["default"].use(Mt.a),n["default"].use(Pt.a),n["default"].use(Tt.a),n["default"].use(Dt.a),n["default"].use(zt.a),n["default"].use(Rt.a),n["default"].use(It.a),n["default"].use(jt.a),n["default"].use(Ct.a),n["default"].use(kt.a),n["default"].use(xt.a),n["default"].use(vt.a),n["default"].use(bt.a),n["default"].use(ft.a),n["default"].use(mt.a),n["default"].use(ut.a),n["default"].use(lt.a),n["default"].use(it.a),n["default"].use(rt.a),n["default"].use(at.a),n["default"].prototype.$message=et.a,n["default"].prototype.$msgbox=Ye.a;a("5aea");var Oa=a("bc3a"),Da=a.n(Oa),Ha=a("c1df"),Ta=a.n(Ha);Ta.a.locale("zh-cn"),Da.a.interceptors.request.use((function(e){return e.headers.Authorization="Bearer "+window.localStorage.getItem("token"),e})),Da.a.interceptors.response.use((function(e){if(!(e.data.code&&e.data.code<100))return e;n["default"].prototype.$message.error(e.data.message),Xe.push("/login")})),Da.a.defaults.baseURL="/api/v1/",n["default"].prototype.$http=Da.a,n["default"].prototype.$echarts=F,n["default"].config.productionTip=!1,n["default"].filter("dateFmt",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"lll";return Ta()(e).format(t)})),new n["default"]({router:Xe,render:function(e){return e(u)}}).$mount("#app")},"578d":function(e,t,a){},"5aea":function(e,t,a){},"5d82":function(e,t,a){},"668c":function(e,t,a){},"6ed5c":function(e,t,a){"use strict";a("578d")},8378:function(e,t,a){"use strict";a("e89a")},"843d":function(e,t,a){"use strict";a("668c")},9156:function(e,t,a){},aefc:function(e,t,a){},b783:function(e,t,a){},b935:function(e,t,a){"use strict";a("9156")},cf05:function(e,t,a){e.exports=a.p+"img/logo.89a4c943.png"},d211:function(e,t,a){},dea4:function(e,t,a){"use strict";a("5d82")},df29:function(e,t,a){},e6c2:function(e,t,a){"use strict";a("1576")},e89a:function(e,t,a){},eea9:function(e,t,a){"use strict";a("df29")}});
//# sourceMappingURL=app.fae1315c.js.map